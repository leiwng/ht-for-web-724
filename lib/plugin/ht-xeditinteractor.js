!function(F,I,O){"use strict";var f="ht",J=F[f],q=J.Default,x=J.graph,X=q.getInternal(),z=X.ui(),H=z.NodeUI.prototype,K=z.ShapeUI.prototype,D=x.GraphView,t=D.prototype,b=z.EdgeUI.prototype,c=J.Node,W=J.Shape,h=J.Edge,m=J.Group,w=q.isTouchable,o=q.isTouchEvent,s=q.preventDefault,r=F.setTimeout,U=q.grow,T=q.isDragging,l=q.getDistance,i=null,j=J.List,g="undefined"!=typeof Float32Array?Float32Array:Array,A=Math,Y=A.PI,P="Crossing",C="No Crossing",n=Y/2,v=2*Y,B=A.atan2,V=A.sqrt,M=A.pow,a=A.sin,N=A.cos,G=A.min,Z=A.max,p=A.abs,e=A.ceil,$=A.round,R=q.unionPoint,S=q.unionRect,k=q.containsPoint,_=q.clone,u="rgb(52, 152, 219)",d="red",E={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},Q={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var u=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],E=0;E<u.length;E++){var N=u[E];N=0===E%2?N/400*Q.width:N/100*Q.height,u[E]=N}return Q.width>120&&(u[4]=Q.width-26,u[6]=Q.width-40,u[10]=Q.width-40,u[12]=Q.width-26,u[18]=33),u}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},L={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:u,rotation:.61},{type:"circle",rect:[200,120,70,70],background:u,rotation:.61},{type:"circle",rect:[200,220,70,70],background:u,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:u},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:u}]},y={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:d,rotation:.61}]},Dq={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:u},{type:"circle",rect:[0,210,90,90],background:u},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:u}]},Qq={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:d},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:d}]},jj={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:u}]},Vk={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:d}]},rp={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Ng={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},fk=function(q){var H=q.touches[0];return H?H:q.changedTouches[0]},wf=function(l,s,T,i){return B(i-s,T-l)},Rj=function(I,C){return{x:I.x*C,y:I.y*C}},yb=function(G,h){G.each(function(b){return G.isSelected(b)?h(b):void 0})},Pl=function(p,U){p.reverseEach(function(R){return p.isSelected(R)?U(R):void 0})},Lr=function(N,e,H){var C,q,m,E,u,G=this,X=e,p=G.gv;if(N instanceof W){m=N.getSegments();var c=p.getDataUI(N);u=c._55O.$15l,m&&m.size()||(m=Oj(u)),N.isClosePath()&&m.indexOf(5)<0&&(m=new j(m._as),m.add(5)),C=sr(N,c,X),q=u[C]}else{var V=p.getDataUI(N);u=Ln(V,N.s("edge.points")),m=N.s("edge.segments"),m&&m.size()||(m=Oj(u)),u=u._as,C=sr(N,V,X),q=u[C]}if(m&&(E=m.get(X)),2===E||1===E||5===E){var Z=u[C+1];5===E&&(Z=u[0]);var b=Ze(q,H,Z);return b}return H},vf=function(Q,K,q,L){var w=K/2,J=q/2,y=Ck(Q,-w,-J,L),m=Ck(Q,w,-J,L),G=Ck(Q,-w,J,L),x=Ck(Q,w,J,L),p=Ck(Q,0,-J,L),o=Ck(Q,w,0,L),E=Ck(Q,0,J,L),n=Ck(Q,-w,0,L);return[y,m,G,x,p,o,E,n]},Ze=function(e,R,S){var Z={x:R.x-e.x,y:R.y-e.y},Y={x:S.x-e.x,y:S.y-e.y},T=V(M(S.x-e.x,2)+M(S.y-e.y,2)),n={x:Y.x/T,y:Y.y/T},d=Z.x*n.x+Z.y*n.y,O={x:n.x*d,y:n.y*d};return{x:e.x+O.x,y:e.y+O.y}},Ck=function(z,U,L,k){var r=N(k)*U-a(k)*L,H=a(k)*U+N(k)*L;return z?{x:z.x+r,y:z.y+H}:{x:r,y:H}},Zb=function(C,b){return b>2*C?C:b/2},Vr=function(M,L,H,F){var V=l(M,L);return H=F?G(H,V):Zb(H,V),V?H/=V:H=0,{x:M.x+(L.x-M.x)*H,y:M.y+(L.y-M.y)*H}},Do=function(F,S){var z,i,f=F.gv,b=F._data,$=b._40I,V=b._41I,x=b.s("edge.offset"),W=b.s("edge.source.position"),A=b.s("edge.target.position"),R=b.s("edge.source.offset.x"),_=b.s("edge.source.offset.y"),U=b.s("edge.target.offset.x"),I=b.s("edge.target.offset.y"),h=b.s("edge.source.anchor.x"),a=b.s("edge.source.anchor.y"),L=b.s("edge.target.anchor.x"),p=b.s("edge.target.anchor.y");if(S?(z=X.getEdgeAgentPosition(f,$,W,R,_,h,a),i=X.getEdgeAgentPosition(f,V,A,U,I,L,p)):(z=X.getEdgeAgentPosition(f,$,W,0,0,h,a),i=X.getEdgeAgentPosition(f,V,A,0,0,L,p)),"points"===b.s("edge.type")&&x&&!b.s("edge.center")&&z){var H=b.s("edge.points")||new j,P=H.size(),u=Vr(z,P?H.get(0):i,x,P),D=Vr(i,P?H.get(P-1):z,x,P);z=u,i=D}return[z,i]},Ln=function(u,O,I){var r=u._78o,A=u._data,V=A.s("edge.type"),c=[r.sourcePoint,r.targetPoint];return"points"===V?I&&(c=Do(u)):c=r.center?V?I?Do(u):Do(u,!0):I?Do(u):[r.c1,r.c2]:I?Do(u):Do(u,!0),O=new j(O?O._as:i),O.add(c[0],0),O.add(c[1]),O},lj=function(V){return V=new j(V._as),V.removeAt(0),V.removeAt(V.size()-1),V},Oj=function(K){K._as||(K=new j(K));var l=new j;l.add(1);for(var k=1;k<K.size();k++)l.add(2);return l},tr=function(f,G){return{x:(f.x+G.x)/2,y:(f.y+G.y)/2}},Ig=function(G,U){return{x:G.x+1*(U.x-G.x)/4,y:G.y+1*(U.y-G.y)/4}},Fj=function(M,n){return{x:M.x+3*(n.x-M.x)/4,y:M.y+3*(n.y-M.y)/4}},Xo=function(m,r,K,G){var Z=r.x+r.width/2,v=r.y+r.height/2,H=V(Z*Z+v*v),R=B(v,Z)+K;return{x:G.x+H*N(R),y:G.y+H*a(R)}},ss=t.validateImpl,od=t.isRectEditable,af=t.isPointEditable,Uo=t._42,lp=K._79o,ir=b._79o,wc=K._48O,Ji=K._47O,Gj=H._48O,Mf=H._80o,Ve=K._80o,kq=H.getSelectWidth,xb=H._47O,Io=b._47O,cn=t.isEditable,yf=["northwest","north","northeast","east","southeast","south","southwest","west"],Bj=function(h,r,e,o,f,A,w,b,n,W){var M=h.x,E=h.y,Z=h.width,t=h.height,x={x:M+Z/2,y:E+t/2};o=o||0,r=Ck(x,r.x-x.x,r.y-x.y,-o),w&&!b&&(r.x+=n,r.y+=W);var g=.01;if("northwest"===e?(r.x+f>M+Z-g&&(r.x=M+Z-f-g),r.y+f>E+t-g&&(r.y=E+t-f-g),h=R(r,{x:M+Z,y:E+t})):"north"===e?(r.y+f>E+t-g&&(r.y=E+t-f-g),h=R({x:M,y:r.y},{x:M+Z,y:E+t})):"northeast"===e?(r.x<M+f+g&&(r.x=M+f+g),r.y+f>E+t-g&&(r.y=E+t-f-g),h=R({x:M,y:r.y},{x:r.x,y:E+t})):"west"===e?(r.x+f>M+Z-g&&(r.x=M+Z-f-g),h=R({x:r.x,y:E},{x:M+Z,y:E+t})):"east"===e?(r.x<M+f+g&&(r.x=M+f+g),h=R({x:M,y:E},{x:r.x,y:E+t})):"southwest"===e?(r.x+f>M+Z-g&&(r.x=M+Z-f-g),r.y<E+f+g&&(r.y=E+f+g),h=R({x:r.x,y:E},{x:M+Z,y:r.y})):"south"===e?(r.y<E+f+g&&(r.y=E+f+g),h=R({x:M,y:E},{x:M+Z,y:r.y})):"southeast"===e&&(r.x<M+f+g&&(r.x=M+f+g),r.y<E+f+g&&(r.y=E+f+g),h=R({x:M,y:E},r)),"keepRatio"===A&&(!w&&b||w&&!b)&&("northeast"===e||"southeast"===e||"northwest"===e||"southwest"===e)){var U=h.width,N=h.height,k=U/Z,B=N/t,V=G(k,B);h.width=Z*V,h.height=t*V,"northeast"===e?h.y=E+(t-h.height):"northwest"===e?(h.y=E+(t-h.height),h.x=M+(Z-h.width)):"southwest"===e&&(h.x=M+(Z-h.width))}h.x-=x.x,h.y-=x.y;var m=Xo(i,h,o,x);return h.x=m.x-h.width/2,h.y=m.y-h.height/2,h},vh=function(I,s,W,x){var u=I.getRotation(),T=s,H=T.x,J=T.y,C=T.width,G=T.height,Z={x:H+T.width/2,y:J+T.height/2};x=Ck(Z,x.x-Z.x,x.y-Z.y,-u),"northwest"===W?T=R(x,{x:H+C,y:J+G}):"north"===W?T=R({x:H,y:x.y},{x:H+C,y:J+G}):"northeast"===W?T=R({x:H,y:x.y},{x:x.x,y:J+G}):"west"===W?T=R({x:x.x,y:J},{x:H+C,y:J+G}):"east"===W?T=R({x:H,y:J},{x:x.x,y:J+G}):"southwest"===W?T=R({x:x.x,y:J},{x:H+C,y:x.y}):"south"===W?T=R({x:H,y:J},{x:H+C,y:x.y}):"southeast"===W&&(T=R({x:H,y:J},x)),I.setRect(T),T.x-=Z.x,T.y-=Z.y;var K=Xo(I,T,u,Z);I.p(K.x,K.y)},Uc=function(V,a,j,Z,o,w,e,u){var m=i;w?(m=Ck(i,o.x-a.x,o.y-a.y,-j),m.x-=e.x,m.y-=e.y):m=Ck(i,o.x-a.x,o.y-a.y,0);var R={x:a.x+m.x,y:a.y+m.y};u&&(R=u(R.x,R.y)),R.e=V.getPoints().get(Z).e,V.setPoint(Z,R);var F=V.getWidth(),$=V.getHeight(),K=V.p().x-F/2,B=V.p().y-$/2;K-=a.x,B-=a.y;var s=Xo(V,{x:K,y:B,width:F,height:$},j,a);V.p(s.x,s.y)},sr=function(n,i,v){var H,R;if(n instanceof W?(H=n.getPoints(),R=n.getSegments()):n instanceof h&&"points"===n.s("edge.type")&&(H=n.s("edge.points"),R=n.s("edge.segments"),H=Ln(i,H)),R&&R.size()||(R=Oj(H)),n instanceof W&&n.isClosePath()&&R.indexOf(5)<0&&(R=new j(R._as),R.add(5)),R)for(var O=-1,A=0;A<R.size();A++){if(A===v)return O;var V=R.get(A);1===V?O+=1:2===V?O+=1:3===V?O+=2:4===V&&(O+=3)}},Mb=function(x,n,f){var P,o;if(x instanceof W?(P=x.getPoints(),o=x.getSegments()):x instanceof h&&"points"===x.s("edge.type")&&(P=x.s("edge.points"),o=x.s("edge.segments"),P=Ln(n,P)),o&&o.size()||(o=Oj(P)),o)for(var V=-1,Z=0;Z<o.size();Z++){var q=o.get(Z);if(1===q?V+=1:2===q?V+=1:3===q?V+=2:4===q&&(V+=3),V===f)return Z}},op=function(b,a){var n=[b[0]-a[0],b[1]-a[1],b[2]-a[2]];return n},Sp=function(){var H=new g(16);return H[0]=1,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=1,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=1,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H},Kf=function(o,n){var I=o[0],j=o[1],r=o[2];return o[0]=n[0]*I+n[4]*j+n[8]*r+n[12],o[1]=n[1]*I+n[5]*j+n[9]*r+n[13],o[2]=n[2]*I+n[6]*j+n[10]*r+n[14],o},rr=function(M,C){if(C){var m=a(C),Y=N(C),f=M[0],S=M[1],W=M[2],q=M[3],T=M[8],J=M[9],h=M[10],k=M[11];M[0]=f*Y-T*m,M[1]=S*Y-J*m,M[2]=W*Y-h*m,M[3]=q*Y-k*m,M[8]=f*m+T*Y,M[9]=S*m+J*Y,M[10]=W*m+h*Y,M[11]=q*m+k*Y}},pi=function(x,X){for(var W=x.s("grid.row.count"),j=x.s("grid.column.count"),D=0;W>D;D++)for(var d=0;j>d;d++){var w=x.getCellRect(D,d);if(k(w,X))return{rowIndex:D,columnIndex:d,rect:w,grid:x}}return null},wd=function(V,l,h,m,_,s){var e={},L=h-V,M=m-l,v=A.sqrt(L*L+M*M),c=L/v,J=M/v,f=(-V+_)*c+(-l+s)*J;return 0>=f?(e.x=V,e.y=l):f>=v?(e.x=h,e.y=m):(e.x=V+f*c,e.y=l+f*J),L=_-e.x,M=s-e.y,e.z=A.sqrt(L*L+M*M),e},np=function(Z,T){var c,V,X,K,H,S,t,G,x=Z.getPoints(),p=Z.getSegments(),z=Z.p(),Y=Z.getRotation();if(!p||!(p.indexOf(3)>0||p.indexOf(4)>0)){for(G=0;G<=x.size()-1;G++)if(G===x.size()-1?(H=x.get(0),K=x.get(G)):(K=x.get(G),H=x.get(G+1)),K=Ck(z,K.x-z.x,K.y-z.y,Y),H=Ck(z,H.x-z.x,H.y-z.y,Y),S=wd(K.x,K.y,H.x,H.y,T.x,T.y),t=S.z,t<(Z.s("shape.border.width")||10)){V=K,X=H,c=G;break}if(c!=i){var s=wd(V.x,V.y,X.x,X.y,T.x,T.y),U=l(V,s);return{attachIndex:c,attachOffset:U}}}},jp=function(R){for(var w=R._data,f=w.p(),K=w.getRotation(),A=w.getPoints(),t=i,Y=[],b=0;b<A.size();b++)t=A.get(b),Y.push(Ck(f,t.x-f.x,t.y-f.y,K));R._55O.$15l=Y};q.setImage("xeditinteractor_parentIcon",L),q.setImage("xeditinteractor_hostIcon",y),q.setImage("xeditinteractor_edgeIcon",Dq),q.setImage("xeditinteractor_removeIcon",Qq),q.setImage("xeditinteractor_sourceIcon",jj),q.setImage("xeditinteractor_targetIcon",Vk),q.setImage("xeditinteractor_elevationIcon",rp),q.setImage("xeditinteractor_tallIcon",Ng),t._editPointSize=w?24:9,t._edgeHelpers=["parent","remove","source","target"],t._leftTopHelpers=["parent"],t._rightTopHelpers=["host"],t._leftBottomHelpers=["edge"],t._rightBottomHelpers=["remove"],yf=yf.concat(yf).concat(yf),b._79o=function(){var k=this,Y=k.gv,z=Y.getZoom(),c=Y._editInteractor,W=ir.call(k);if(!W)return null;var J=Do(k,!0),j=J[0],O=J[1],f={x:W.x,y:W.y,width:W.width,height:W.height},Q=R(j,O);if(c instanceof x.XEditInteractor){f=S(f,Q);var r=k._55O,l=Y.getEditPointSize()/z+2,a=0;r&&r._43O&&(a+=l/2,U(f,a))}return f},b._47O=function(Z){var a=this,V=a.gv,y=V._editInteractor;y instanceof x.XEditInteractor||Io.call(a,Z)},b.rectIntersects=function(T){var d=this,y=d._data,V=d.gv,q=V.getZoom(),A=d._55O,v=V._editInteractor;if(v instanceof x.XEditInteractor&&V.isEditable(y)&&A&&A._43O&&"points"===y.s("edge.type")){var n=y.s("edge.points"),Z=y.s("edge.segments");n=Ln(d,n),Z&&Z.size()||(Z=Oj(n)),n=n._as;var C=!1,a=w?5:1,E=T.x+a,t=T.y+a,W={x:E,y:t};if(v._edge===y&&v._hoverSegmentIndex>=0){var B=V._editInteractor._hoverSegmentIndex,D=Z.get(B),h=sr(y,d,B),F=i;if(h!=i&&h>=0){var j=n[h],J=V.getSegmentHoverWidth()/q;if(2===D||1===D){var z=n[h+1];F=kd(new Lb(j.x,j.y),new Lb(z.x,z.y),new Lb(W.x-J,W.y-J),new Lb(W.x+2*J,W.y+2*J)),F.$62l===P&&(C=!0)}else if(3===D){var N=n[h+1],z=n[h+2];F=Yn(new Lb(j.x,j.y),new Lb(N.x,N.y),new Lb(z.x,z.y),new Lb(W.x-J,W.y-J),new Lb(W.x+2*J,W.y+2*J)),F.$62l===P&&(C=!0)}else if(4===D){var u=n[h+1],$=n[h+2];z=n[h+3],F=Gc(new Lb(j.x,j.y),new Lb(u.x,u.y),new Lb($.x,$.y),new Lb(z.x,z.y),new Lb(W.x-J,W.y-J),new Lb(W.x+2*J,W.y+2*J)),F.$62l===P&&(C=!0)}}}if(C)return!0}return i},K._47O=function(v){var m=this,B=m.gv,h=B._editInteractor;h instanceof x.XEditInteractor||Ji.call(m,v)},K.rectIntersects=function(z){var b=this,p=b._data,Y=b.gv,f=Y.getZoom(),L=b._55O,Q=Y._editInteractor;if(Q instanceof x.XEditInteractor&&Y.isEditable(p)&&L&&L._43O){var J=L.$15l,s=!1,h=w?5:1,U=z.x+h,o=z.y+h,B={x:U,y:o};if(J&&J.length===p.getPoints().size()||(jp(b),J=L.$15l),Q._shape===p&&Q._hoverSegmentIndex>=0){var X=p.getSegments();X&&X.size()||(X=Oj(J));var I=Y._editInteractor._hoverSegmentIndex,v=X.get(I),q=sr(p,b,I),R=i;if(q!=i&&q>=0){var u=J[q],k=Y.getSegmentHoverWidth()/f;if(2===v||1===v){var r=J[q+1];R=kd(new Lb(u.x,u.y),new Lb(r.x,r.y),new Lb(B.x-k,B.y-k),new Lb(B.x+2*k,B.y+2*k)),R.$62l===P&&(s=!0)}else if(3===v){var j=J[q+1],r=J[q+2];R=Yn(new Lb(u.x,u.y),new Lb(j.x,j.y),new Lb(r.x,r.y),new Lb(B.x-k,B.y-k),new Lb(B.x+2*k,B.y+2*k)),R.$62l===P&&(s=!0)}else if(4===v){var _=J[q+1],g=J[q+2];r=J[q+3],R=Gc(new Lb(u.x,u.y),new Lb(_.x,_.y),new Lb(g.x,g.y),new Lb(r.x,r.y),new Lb(B.x-k,B.y-k),new Lb(B.x+2*k,B.y+2*k)),R.$62l===P&&(s=!0)}}}if(s)return!0}return i},K._48O=function(){var X=this,Q=X.gv,S=Q._editInteractor;S instanceof x.XEditInteractor?(H._48O.call(X),X._55O._43O&&jp(X)):wc.call(X)},K._79o=function(){var E=this,l=E.gv,X=l.getZoom(),K=l._editInteractor,J=lp.call(E);if(J){var w={x:J.x,y:J.y,width:J.width,height:J.height};if(K instanceof x.XEditInteractor){var O=E._55O,$=l.getEditPointSize()/X+2,d=0;O&&O._43O&&(d+=$/2,U(w,d))}return w}},H._47O=function(a){var I=this,B=I.gv,C=B._editInteractor;if(C instanceof x.XEditInteractor);else{var t=I._55O;t&&t._98o&&xb.call(I,a)}},H.getSelectWidth=function(){var n=this,W=n.gv,f=W._editInteractor,y=n._data;return W.isEditable(y)&&f instanceof x.XEditInteractor?0:kq.call(n)},H._80o=function(R){var I=this,y=I.gv._editInteractor;if(Mf.call(I,R),y&&y._debug){R.save(),R.beginPath(),R.lineWidth=1,R.strokeStyle="green";var O=I._79o();O&&(R.rect(O.x,O.y,O.width,O.height),R.stroke()),R.restore()}},K._80o=function(B){var U=this,v=U.gv._editInteractor;if(Ve.call(U,B),v&&v._debug){B.save(),B.beginPath(),B.lineWidth=1,B.strokeStyle="green";var T=U._79o();B.rect(T.x,T.y,T.width,T.height),B.stroke(),B.restore()}},H._48O=function(){var c=this,u=c.gv,C=c._data,q=u._editInteractor,V=c._55O,D=C.p(),a=C.getRotation();if(q instanceof x.XEditInteractor){if(V._42O){var n=vf(D,C.getWidth(),C.getHeight(),a),J=n[0],U=n[1],Q=n[2],y=n[3],v=n[4],E=n[5],L=n[6],R=n[7];V.$45l=[J,v,U,E,y,L,Q,R]}}else Gj.call(c)},t.getResizeMode=function(){return this.$25l||"normal"},t.setResizeMode=function(b){var x=this.$25l;this.$25l=b,this.fp("resizeMode",x,b)},t.getSnapAngle=function(){return this.$26l||Math.PI/36},t.setSnapAngle=function(u){var X=this.$26l;this.$26l=u,this.fp("snapAngle",X,u)},t.getSnapSpacing=function(){return this.$27l},t.setSnapSpacing=function(d){var Q=this.$27l;this.$27l=d,this.fp("snapSpacing",Q,d)},t.getPointSnapSpacing=function(){return this._pointSnapSpacing},t.setPointSnapSpacing=function(v){var w=this._pointSnapSpacing;this._pointSnapSpacing=v,this.fp("pointSnapSpacing",w,v)},t.setHelperEditableFunc=function(f){var w=this._helperEditableFunc;this._helperEditableFunc=f,this.fp("helperEditableFunc",w,f)},t.getHelperEditableFunc=function(){return this._helperEditableFunc},t.setLeftTopHelpers=function(z){var Z=this._leftTopHelpers;this._leftTopHelpers=z,this.fp("leftTopHelpers",Z,z)},t.getLeftTopHelpers=function(){return this._leftTopHelpers},t.setLeftTopHelpersAlign=function(e){var I=this._leftTopHelpersAlign;this._leftTopHelpersAlign=e,this.fp("leftTopHelpersAlign",I,e)},t.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},t.setRightTopHelpers=function(R){var z=this._rightTopHelpers;this._rightTopHelpers=R,this.fp("rightTopHelpers",z,R)},t.getRightTopHelpers=function(){return this._rightTopHelpers},t.setRightTopHelpersAlign=function(m){var o=this._rightTopHelpersAlign;this._rightTopHelpersAlign=m,this.fp("rightTopHelpersAlign",o,m)},t.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},t.setLeftBottomHelpers=function(J){var X=this._leftBottomHelpers;this._leftBottomHelpers=J,this.fp("leftBottomHelpers",X,J)},t.getLeftBottomHelpers=function(){return this._leftBottomHelpers},t.setLeftBottomHelpersAlign=function(z){var T=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=z,this.fp("leftBottomHelpersAlign",T,z)},t.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},t.setRightBottomHelpers=function(I){var U=this._rightBottomHelpers;this._rightBottomHelpers=I,this.fp("rightBottomHelpers",U,I)},t.getRightBottomHelpers=function(){return this._rightBottomHelpers},t.setRightBottomHelpersAlign=function(W){var O=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=W,this.fp("rightBottomHelpersAlign",O,W)},t.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},t.setEdgeHelpers=function(O){var k=this._edgeHelpers;this._edgeHelpers=O,this.fp("edgeHelpers",k,O)},t.getEdgeHelpers=function(){return this._edgeHelpers},t.isHelperEditable=function(_,B){return _ instanceof h&&("host"===B||"edge"===B||"elevation"===B||"tall"===B)?!1:_ instanceof c&&("source"===B||"target"===B)?!1:"pointElevation"===B?this._helperEditableFunc?this._helperEditableFunc(_,B):!1:this._helperEditableFunc?this._helperEditableFunc(_,B):!0},t.getEditHelperSize=function(){return this._editHelperSize||(w?28:16)},t.setEditHelperSize=function(H){var W=this._editHelperSize;this._editHelperSize=H,this.fp("editHelperSize",W,H)},t.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},t.setEditRectBorderColor=function(z){var h=this.$28l;this.$28l=z,this.fp("editRectBorderColor",h,z)},t.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},t.setNodeBorderColor=function(H){var j=this.$29l;this.$29l=H,this.fp("nodeBorderColor",j,H)},t.getEditRectBorderStyle=function(){return this.$30l||"dashed"},t.setEditRectBorderStyle=function(E){var L=this.$30l;this.$30l=E,this.fp("editRectBorderStyle",L,E)},t.getControlPointBackground=function(){return this.$31l||"#ff0"},t.setControlPointBackground=function(O){var f=this.$31l;this.$31l=O,this.fp("controlPointBackground",f,O)},t.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},t.setControlPointBorderColor=function(Q){var A=this.$32l;this.$32l=Q,this.fp("controlPointBorderColor",A,Q)},t.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},t.setJoinPointBackground=function(Z){var G=this.$33l;this.$33l=Z,this.fp("joinPointBackground",G,Z)},t.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},t.setJoinPointBorderColor=function(U){var t=this.$34l;this.$34l=U,this.fp("joinPointBorderColor",t,U)},t.getDirectionLineColor=function(){return this.$35l||"#888"},t.setDirectionLineColor=function($){var e=this.$35l;this.$35l=$,this.fp("directionLineColor",e,$)},t.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},t.setSegmentHoverColor=function(h){var y=this.$36l;this.$36l=h,this.fp("segmentHoverColor",y,h)},t.getSegmentHoverWidth=function(){return this.$22l||(w?16:8)},t.setSegmentHoverWidth=function(u){var N=this.$22l;this.$22l=u,this.fp("segmentHoverWidth",N,u)},t.getSnapPointBorderColor=function(){return this.$38l||"#f00"},t.setSnapPointBorderColor=function(g){var z=this.$38l;this.$38l=g,this.fp("snapPointBorderColor",z,g)},t.getEditRectPadding=function(){return this.$39l!=i?this.$39l:6},t.setEditRectPadding=function(v){var H=this.$39l;this.$39l=v,this.fp("editRectPading",H,v)},t.isRectEditable=function(M){var f=this,X=f._editInteractor;return X instanceof x.XEditInteractor?f._rectEditableFunc?f._rectEditableFunc(M):!0:od.call(f,M)},t.isPointEditable=function(B){var h=this,l=h._editInteractor;return l instanceof x.XEditInteractor?h._pointEditableFunc?h._pointEditableFunc(B):!0:af.call(h,B)},t.validateImpl=function(){var B=this,u=B.$14l,V=B._editInteractor;if(u){var Z=B.getWidth(),I=B.getHeight();(Z!==u.clientWidth||I!==u.clientHeight)&&(V&&(V._68I=1),X.setCanvas(u,Z,I),B._32I=1)}ss.call(this)},t.isEditable=function(k){var $=cn.call(this,k),J=this._editInteractor;if(J instanceof x.XEditInteractor&&k instanceof h){if(!k.s("2d.editable"))return!1;var j=this.getEditableFunc();$=j?j(k):!0}return $},t._42=function(X,H){var R=this,o=R._editInteractor;Uo.call(R,X,H),o instanceof x.XEditInteractor&&o._68I&&o._42()},t.isSnapPoint=function(){return!0};var zs=function(e){arguments.length>0&&this.$58l(e)},is=zs.prototype;is.$58l=function($){this.$62l=$,this.points=new Array},is.$56l=function(J){this.points.push(J)},is.$57l=function(h){this.points=this.points.concat(h)};var Lb=function(z,i){arguments.length>0&&this.$58l(z,i)},Ub=Lb.prototype;Ub.$58l=function(W,P){this.x=W,this.y=P},Ub.add=function(E){return new Lb(this.x+E.x,this.y+E.y)},Ub.addEquals=function(t){return this.x+=t.x,this.y+=t.y,this},Ub.$55l=function(y){return new Lb(this.x*y,this.y*y)},Ub.eq=function(x){return this.x==x.x&&this.y==x.y},Ub.lt=function($){return this.x<$.x&&this.y<$.y},Ub.lte=function(B){return this.x<=B.x&&this.y<=B.y},Ub.gt=function(z){return this.x>z.x&&this.y>z.y},Ub.gte=function(y){return this.x>=y.x&&this.y>=y.y},Ub.lerp=function(O,B){return new Lb(this.x+(O.x-this.x)*B,this.y+(O.y-this.y)*B)},Ub.distanceFrom=function(w){var Q=this.x-w.x,E=this.y-w.y;return V(Q*Q+E*E)},Ub.min=function(m){return new Lb(G(this.x,m.x),G(this.y,m.y))},Ub.max=function(g){return new Lb(Z(this.x,g.x),Z(this.y,g.y))},Ub.toString=function(){return this.x+","+this.y};var mk=function(){this.$58l(arguments)},cf=mk.prototype;mk.TO=1e-6,mk.AC=6,cf.$58l=function(f){this.co=new Array;for(var Y=f.length-1;Y>=0;Y--)this.co.push(f[Y])},cf.$55l=function(t){for(var G=new mk,Q=0;Q<=this.$50l()+t.$50l();Q++)G.co.push(0);for(var Q=0;Q<=this.$50l();Q++)for(var S=0;S<=t.$50l();S++)G.co[Q+S]+=this.co[Q]*t.co[S];return G},cf.$59l=function(){for(var x=this.$50l();x>=0&&p(this.co[x])<=mk.TO;x--)this.co.pop()},cf.$50l=function(){return this.co.length-1},cf.$51l=function(){var q;switch(this.$59l(),this.$50l()){case 0:q=new Array;break;case 1:q=this.$52l();break;case 2:q=this.$53l();break;case 3:q=this.$54l();break;case 4:q=this.$63l();break;default:q=new Array}return q},cf.$52l=function(){var E=new Array,B=this.co[1];return 0!=B&&E.push(-this.co[0]/B),E},cf.$53l=function(){var d=new Array;if(2==this.$50l()){var l=this.co[2],g=this.co[1]/l,P=this.co[0]/l,h=g*g-4*P;if(h>0){var q=V(h);d.push(.5*(-g+q)),d.push(.5*(-g-q))}else 0==h&&d.push(.5*-g)}return d},cf.$63l=function(){var N=new Array;if(4==this.$50l()){var J=this.co[4],z=this.co[3]/J,I=this.co[2]/J,s=this.co[1]/J,q=this.co[0]/J,M=new mk(1,-I,z*s-4*q,-z*z*q+4*I*q-s*s).$54l(),Z=M[0],D=z*z/4-I+Z;if(p(D)<=mk.TO&&(D=0),D>0){var c=V(D),O=3*z*z/4-c*c-2*I,t=(4*z*I-8*s-z*z*z)/(4*c),m=O+t,h=O-t;if(p(m)<=mk.TO&&(m=0),p(h)<=mk.TO&&(h=0),m>=0){var C=V(m);N.push(-z/4+(c+C)/2),N.push(-z/4+(c-C)/2)}if(h>=0){var C=V(h);N.push(-z/4+(C-c)/2),N.push(-z/4-(C+c)/2)}}else if(0>D);else{var t=Z*Z-4*q;if(t>=-mk.TO){if(0>t&&(t=0),t=2*V(t),O=3*z*z/4-2*I,O+t>=mk.TO){var R=V(O+t);N.push(-z/4+R/2),N.push(-z/4-R/2)}if(O-t>=mk.TO){var R=V(O-t);N.push(-z/4+R/2),N.push(-z/4-R/2)}}}}return N},cf.$54l=function(){var u=new Array;if(3==this.$50l()){var F=this.co[3],h=this.co[2]/F,W=this.co[1]/F,i=this.co[0]/F,s=(3*W-h*h)/3,r=(2*h*h*h-9*W*h+27*i)/27,o=h/3,d=r*r/4+s*s*s/27,O=r/2;if(p(d)<=mk.TO&&(d=0),d>0){var g,e,l=V(d);g=-O+l,e=g>=0?M(g,1/3):-M(-g,1/3),g=-O-l,g>=0?e+=M(g,1/3):e-=M(-g,1/3),u.push(e-o)}else if(0>d){var K=V(-s/3),J=B(V(-d),-O)/3,$=N(J),f=a(J),_=V(3);u.push(2*K*$-o),u.push(-K*($+_*f)-o),u.push(-K*($-_*f)-o)}else{var g;g=O>=0?-M(O,1/3):M(-O,1/3),u.push(2*g-o),u.push(-g-o)}}return u};var Yc=function(V,e){arguments.length>0&&this.$58l(V,e)},dl=Yc.prototype;dl.$58l=function(F,C){this.x=F,this.y=C},dl.length=function(){return V(this.x*this.x+this.y*this.y)},dl.$60l=function(g){return this.x*g.x+this.y*g.y};var xk=function(K,Y,D,O){var R,s=(O.x-D.x)*(K.y-D.y)-(O.y-D.y)*(K.x-D.x),V=(Y.x-K.x)*(K.y-D.y)-(Y.y-K.y)*(K.x-D.x),S=(O.y-D.y)*(Y.x-K.x)-(O.x-D.x)*(Y.y-K.y);if(0!=S){var U=s/S,y=V/S;U>=0&&1>=U&&y>=0&&1>=y?(R=new zs(P),R.points.push(new Lb(K.x+U*(Y.x-K.x),K.y+U*(Y.y-K.y)))):R=new zs(C)}else R=0==s||0==V?new zs("C"):new zs("P");return R},sq=function(d,U,M,E,S){var v,q,Z,b,O,i,T,m=E.min(S),A=E.max(S),c=new zs(C);v=U.$55l(-2),Z=d.add(v.add(M)),v=d.$55l(-2),q=U.$55l(2),b=v.add(q),O=new Lb(d.x,d.y),T=new Yc(E.y-S.y,S.x-E.x),i=E.x*S.y-S.x*E.y;for(var L=new mk(T.$60l(Z),T.$60l(b),T.$60l(O)+i).$51l(),y=0;y<L.length;y++){var R=L[y];if(R>=0&&1>=R){var j=d.lerp(U,R),z=U.lerp(M,R),t=j.lerp(z,R);E.x==S.x?m.y<=t.y&&t.y<=A.y&&(c.$62l=P,c.$56l(t)):E.y==S.y?m.x<=t.x&&t.x<=A.x&&(c.$62l=P,c.$56l(t)):t.gte(m)&&t.lte(A)&&(c.$62l=P,c.$56l(t))}}return c},Yn=function(M,A,f,i,r){var G=i.min(r),o=i.max(r),U=new Lb(o.x,G.y),v=new Lb(G.x,o.y),l=sq(M,A,f,G,U),t=sq(M,A,f,U,o),X=sq(M,A,f,o,v),I=sq(M,A,f,v,G),D=new zs(C);return D.$57l(l.points),D.$57l(t.points),D.$57l(X.points),D.$57l(I.points),D.points.length>0&&(D.$62l=P),D},km=function(a,X,S,I,y,z){var F,W,A,h,f,v,s,H,K,p,c=y.min(z),T=y.max(z),V=new zs(C);F=a.$55l(-1),W=X.$55l(3),A=S.$55l(-3),h=F.add(W.add(A.add(I))),f=new Yc(h.x,h.y),F=a.$55l(3),W=X.$55l(-6),A=S.$55l(3),h=F.add(W.add(A)),v=new Yc(h.x,h.y),F=a.$55l(-3),W=X.$55l(3),A=F.add(W),s=new Yc(A.x,A.y),H=new Yc(a.x,a.y),p=new Yc(y.y-z.y,z.x-y.x),K=y.x*z.y-z.x*y.y;for(var q=new mk(p.$60l(f),p.$60l(v),p.$60l(s),p.$60l(H)+K).$51l(),g=0;g<q.length;g++){var j=q[g];if(j>=0&&1>=j){var J=a.lerp(X,j),M=X.lerp(S,j),Y=S.lerp(I,j),u=J.lerp(M,j),L=M.lerp(Y,j),m=u.lerp(L,j);y.x==z.x?c.y<=m.y&&m.y<=T.y&&(V.$62l=P,V.$56l(m)):y.y==z.y?c.x<=m.x&&m.x<=T.x&&(V.$62l=P,V.$56l(m)):m.gte(c)&&m.lte(T)&&(V.$62l=P,V.$56l(m))}}return V},Gc=function(c,l,R,U,r,H){var D=r.min(H),t=r.max(H),X=new Lb(t.x,D.y),Z=new Lb(D.x,t.y),B=km(c,l,R,U,D,X),o=km(c,l,R,U,X,t),V=km(c,l,R,U,t,Z),N=km(c,l,R,U,Z,D),O=new zs(C);return O.$57l(B.points),O.$57l(o.points),O.$57l(V.points),O.$57l(N.points),O.points.length>0&&(O.$62l=P),O},kd=function(H,U,p,j){var e=p.min(j),a=p.max(j),X=new Lb(a.x,e.y),M=new Lb(e.x,a.y),E=xk(e,X,H,U),I=xk(X,a,H,U),s=xk(a,M,H,U),G=xk(M,e,H,U),F=new zs(C);return F.$57l(E.points),F.$57l(I.points),F.$57l(s.points),F.$57l(G.points),F.points.length>0&&(F.$62l=P),F},Qd=x.XEditInteractor=function(d){var q=this,f=q._view=document.createElement("canvas");f.className="editCanvas",f.style.position="absolute",Qd.superClass.constructor.call(q,d)};q.def(Qd,x.Interactor,{ms_edit:1,setUp:function(){var t=this,v=t.gv,r=v.getView(),F=t._view;Qd.superClass.setUp.call(t),v.setEditInteractor(t),v.$14l=F,v._79O?r.insertBefore(F,v._79O):r.appendChild(F);var S=t.$49l=t.$11l.bind(t);v.dm().md(S),v.sm().ms(S),v.mp(S)},tearDown:function(){var M=this,C=M.gv,Y=C.getView(),x=M.$49l;Qd.superClass.tearDown.call(M),C.setEditInteractor(i),C.$14l=i,Y.removeChild(M._view),C.dm().umd(x),C.sm().ums(x),C.ump(x)},clear:function(){var Q=this,r=Q.gv;delete Q._hoverSegmentIndex,delete Q._edge,delete Q._shape,delete r._editing,delete Q.$10l,delete Q.$13l,delete Q.$9l,delete Q._removePointIndex,delete Q._lp,Q.$12l="",delete Q.$40l,delete Q.$67l,delete Q.$72l,delete Q.$73l,delete Q.$75l,delete Q.$1l,delete Q.$3l,delete Q.$2l,delete Q.$92l,delete Q.$93l,delete Q.$94l,Q.clearDragging()},handle_keydown:function(L){this.$48l!==L.shiftKey&&(this.$48l=L.shiftKey,this.handle_mousemove(L,O,!0))},handle_keyup:function(E){this.$48l!==E.shiftKey&&(this.$48l=E.shiftKey,this.handle_mousemove(E,O,!0))},handle_touchstart:function($){this.handle_mousemove($),this.handle_mousedown($)},handle_mousedown:function(Q){s(Q);var y=this,D=y.$13l,k=y.gv,U=k.dm(),Z=k.sm(),t=k.getZoom(),i=k.lp(Q),R=q.isDoubleClick(Q),e=q.isLeftButton(Q),l=y.$7l,I=y._shape,h=y._hoverSegmentIndex,n=y._edge,a=y.$87l,F=y.$88l,u=function(){y._68I||a===y.$87l&&F===y.$88l||y.$43l()};if(7!==y.$67l&&(delete y.$87l,delete y.$88l),e&&(I||n)&&h>=0&&R&&(I&&Z.contains(I)||n&&Z.contains(n))){var N=Lr.call(y,I||n,h,i);return y.addShapePoint(I||n,h,N),r(function(){y.handle_mousemove(Q)},40),void 0}if(e&&(I||n)&&y._removePointIndex>=0&&R)return y.removeShapePoint(),y.$5l=1,r(function(){y.handle_mousemove(Q)},40),void 0;if(!e||!k._editing)return u(),void 0;if(I&&D>=0){var T=I.getPoints().get(D),o=I.p(),g=Ck(o,T.x-o.x,T.y-o.y,-l+I.getRotation());S=Ck(o,i.x-o.x,i.y-o.y,-l),y.$24l={x:S.x-g.x,y:S.y-g.y},y.startDragging(Q),U.beginTransaction(),y.fi({kind:"beginEditPoint",event:Q,data:I,index:D}),y.$88l=D,y.$87l=I}else if(y.$10l){var C=k.sm().getSelection(),X=y.$6l,m=y.$1l={},w=y.$3l={},V=y.$16l[E[y.$10l]],d={x:X.x,y:X.y},z={x:X.x+X.width/2,y:X.y+X.height/2};y.$24l={x:i.x-V.x/t,y:i.y-V.y/t},y.$2l=_(y.$8l),y.$4l=_(X),C.each(function(v){if(v instanceof c){var G=v.p(),T=v.getWidth(),N=v.getHeight(),g=Ck(z,G.x-z.x,G.y-z.y,-l);m[v.getId()]={x:G.x-T/2,y:G.y-N/2,width:T,height:N},w[v.getId()]={x:(g.x-d.x)/X.width,y:(g.y-d.y)/X.height}}}),y.startDragging(Q),U.beginTransaction(),y.fi({kind:"beginEditRect",event:Q,direction:y.$10l})}else if(n&&D>=0){var Y=Ln(k.getDataUI(n),n.s("edge.points")),T=Y.get(D);y.$24l={x:i.x-T.x,y:i.y-T.y},y.startDragging(Q),U.beginTransaction(),y.fi({kind:"beginEditPoint",event:Q,data:n,index:D}),y.$88l=D,y.$87l=n}else if(y.$40l){var X=y.$6l,z={x:X.x+X.width/2,y:X.y+X.height/2},x=_(y.$23l);x.x/=t,x.y/=t;var L=Ck(z,x.x-z.x,x.y-z.y,-l),S=Ck(z,i.x-z.x,i.y-z.y,-l);y.$24l={x:S.x-L.x,y:S.y-L.y},y.startDragging(Q),U.beginTransaction(),y.fi({kind:"beginEditRotation",event:Q,data:y._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(y.$67l)>=0){var $=y.$67l;(7===$||8===$||9===$)&&U.beginTransaction(),y.startDragging(Q)}else if(y.$71l&&R&&y.$79l(y.$71l,i)){var B=Z.toSelection();U.beginTransaction(),B.each(function(G){U.remove(G)}),U.endTransaction()}u()},$11l:function(){var l=this,z=l.gv;z._editing&&(l.$13l==i||l._shape==i&&l._edge==i)&&(l.$73l==i||1!==l.$67l&&5!==l.$67l&&6!==l.$67l)||(l.$5l=1),l._68I=1},$46l:function(W){var R=this,A=R.gv,e=A.lp(W),l=[];return Pl(A,function(Y){var G=A.getDataUI(Y);if(G){var K=G._79o();k(K,e)&&l.push(Y)}}),l},$47l:function(D){var z=this,l=z.$13l,N=z.gv.dm();z.$10l?(z.fi({kind:"endEditRect",event:D,direction:z.$10l}),N.endTransaction()):z._shape&&l>=0?(z.fi({kind:"endEditPoint",event:D,data:z._shape,index:l}),N.endTransaction()):z._edge&&l>=0?(z.fi({kind:"endEditPoint",event:D,data:z._edge,index:l}),N.endTransaction()):z.$23l&&z.$40l&&(z.fi({kind:"endEditRotation",event:D}),N.endTransaction())},handleWindowTouchEnd:function(u){this.handleWindowMouseUp(u)},handleWindowMouseUp:function(G){var L=this,f=L.gv,u=f.dm(),g=L._shape,Z=L._edge,w=L.$13l,T=L.$40l,I=L.$9l,F=L.$10l,x=L.$67l;if((g||Z)&&w>=0&&I>=0){var m,d;if(g){var t=g.p(),l=g.getRotation();m=g.getPoints(),d=m.get(I),Uc(g,t,l,w,d,!1)}else if(m=Ln(f.getDataUI(Z),Z.s("edge.points"),!0),d=m.get(I),0===w){var K=m.get(0);Z.s("edge.source.offset.x",d.x-K.x),Z.s("edge.source.offset.y",d.y-K.y)}else if(w===m.size()-1){var y=m.get(m.size()-1);Z.s("edge.target.offset.x",d.x-y.x),Z.s("edge.target.offset.y",d.y-y.y)}else"points"===Z.s("edge.type")&&(m.set(w,d),Z.s("edge.points",lj(m)))}L.$47l(G);var N=L.$73l;1===x?(u.beginTransaction(),N?f.sm().each(function(c){if(c.setHost&&f.isHelperEditable(c,"host")){c.setHost(N);
var o=L.$75l,S=L.$74l;o&&(c.s("attach.row.index",o.rowIndex),c.s("attach.column.index",o.columnIndex)),S&&(c.s("attach.index",S.attachIndex),c.s("attach.offset",S.attachOffset),c.s("attach.offset.relative",!1),c.s("attach.offset.opposite",!1))}}):f.sm().each(function(W){W.setHost&&f.isHelperEditable(W,"host")&&(W.setHost(i),W.s("attach.row.index",O),W.s("attach.column.index",O),W.s("attach.index",O),W.s("attach.offset",O),W.s("attach.offset.relative",!1),W.s("attach.offset.opposite",!1))}),u.endTransaction()):2===x?(u.beginTransaction(),N?f.sm().each(function(A){A.setParent&&f.isHelperEditable(A,"parent")&&A.setParent(N)}):f.sm().each(function(B){B.setParent&&f.isHelperEditable(B,"parent")&&B.setParent(i)}),u.endTransaction()):3===x?N&&(u.beginTransaction(),f.sm().each(function(Z){if(f.isHelperEditable(Z,"edge")&&Z instanceof c&&N instanceof c){var I=new J.Edge;u.add(I),I.setSource(Z),I.setTarget(N),L.onEdgeCreated&&L.onEdgeCreated(G,I)}}),u.endTransaction()):5===x||6===x?N&&(u.beginTransaction(),f.sm().each(function(T){T instanceof h&&N instanceof c&&(5===x&&f.isHelperEditable(T,"source")?T.setSource(N):6===x&&f.isHelperEditable(T,"source")&&T.setTarget(N))}),u.endTransaction()):(7===x||8===x||9===x)&&u.endTransaction(),(F||T)&&L.$43l(!0),o(G)?(L.clear(),delete L.$64l,L._68I||L.$43l()):(L.handle_mousemove(G,!0),x&&!L._68I&&L.$43l())},handleWindowTouchMove:function(Q){this.handleWindowMouseMove(Q)},handleWindowMouseMove:function(J){this._78I(J)},handle_mousemove:function(N,n,m){if(!this._pause){if(!m){var $=o(N)?fk(N):N;this.$61l={clientX:$.clientX,clientY:$.clientY}}if(n===!0||!T()){var d=this,C=d.gv,f=!1,p=i;d.clear(),C.sm().size()>0&&(p=C.lp(m?d.$61l:N),f=d._79I(N,p)),f&&(C._editing=1),d.$12l!==d.$65l&&(d.$65l=d.$12l,d.setCursor(d.$12l)),d.$40l!==d.$64l&&(d.$64l=d.$40l,d._68I||d.$43l()),d._hoverSegmentIndex!==d.$66l&&(d.$66l=d._hoverSegmentIndex,d._68I||d.$43l())}}},_78I:function(T){this.autoScroll(T);var b=this,E=b.gv,d=E.lp(T),P=E.getZoom(),s=b.$13l;if((b._shape||b._edge)&&s>=0){var D,k,K,L=b._shape,U=b._edge,_=b.$24l,y=E.getPointSnapSpacing(),C=function(F,m){return y==i||isNaN(y)?{x:F,y:m}:{x:$(F/y)*y,y:$(m/y)*y}};if(L){D=L.getPoints();var e=L.p(),S=L.getRotation(),H=0;k=Ck(e,d.x-e.x,d.y-e.y,-S),Uc(L,e,S,s,d,!0,_,C),b.fi({kind:"betweenEditPoint",event:T,data:L,index:s})}else if(U){D=Ln(E.getDataUI(U),U.s("edge.points"),!0),d.x-=_.x,d.y-=_.y,k=d;var g,G,m=U.s("edge.offset"),N=D.size(),a=N>2;if(0===s){var z=D.get(0);m&&(z=Vr(z,D.get(1),-m,a),d=Vr(d,D.get(1),-m,a)),g=d.x-z.x,G=d.y-z.y,K=C(g,G),U.s("edge.source.offset.x",K.x),U.s("edge.source.offset.y",K.y)}else if(s===N-1){var F=D.get(N-1);m&&(F=Vr(F,D.get(N-2),-m,a),d=Vr(d,D.get(N-2),-m,a)),g=d.x-F.x,G=d.y-F.y,K=C(g,G),U.s("edge.target.offset.x",K.x),U.s("edge.target.offset.y",K.y)}else"points"===U.s("edge.type")&&(K=C(d.x,d.y),K.e=D.get(s).e,D.set(s,K),U.s("edge.points",lj(D)));b.fi({kind:"betweenEditPoint",event:T,data:U,index:s})}if(delete b.$9l,E.isSnapPoint(L)||E.isSnapPoint(U))for(H=0;H<D.size();H++)if(H!==s){var o=D.get(H);if(l(o,k)<E.getEditPointSize()/P){b.$9l=H;break}}}else if(b.$10l){var _=b.$24l;d.x-=_.x,d.y-=_.y;var R=E.sm().getSelection(),A=b.$1l,t=b.$7l,Z=b.$10l,J=b.$4l,M=b.$2l,w=E.getEditRectPadding()/P,j=2*w,X=E.getSnapSpacing(),I=X!=i&&!isNaN(X),x=Bj(M,d,Z,t,2*w,E.getResizeMode(),I,!0),O=b.$6l;if(I){var u=x.width-j,Q=x.height-j,f=$(u/X)*X,Jq=$(Q/X)*X,Ee=f-u,Rm=Jq-Q;("west"===Z||"northwest"===Z||"southwest"===Z)&&(Ee=-Ee),("north"===Z||"northwest"===Z||"northeast"===Z)&&(Rm=-Rm),x=Bj(M,d,Z,t,2*w,E.getResizeMode(),I,!1,Ee,Rm)}b.$8l=x,O.x=x.x+w,O.y=x.y+w,O.width=x.width-j,O.height=x.height-j;var ok=x.x+x.width/2,mb=x.y+x.height/2,Aq=O.x,on=O.y,Qk=O.width/J.width,bq=O.height/J.height;R.each(function(N){if(N instanceof c&&E.isEditable(N)&&E.isRectEditable(N)){var S=A[N.getId()],I=b.$3l[N.getId()],l={x:S.x+S.width/2,y:S.y+S.height/2},C=0,y=0,g=Z,F=180*p(t-N.getRotation())/Y;"northeast"===Z?F>=315||45>F?(C=S.width*Qk+S.x,y=S.height*(1-bq)+S.y,g="northeast"):F>=45&&135>F?(C=S.width*(1-bq)+S.x,y=S.height*(1-Qk)+S.y,g="northwest"):F>=135&&225>F?(C=S.width*(1-Qk)+S.x,y=S.height*bq+S.y,g="southwest"):(C=S.width*bq+S.x,y=S.height*Qk+S.y,g="southeast"):"north"===Z?F>=315||45>F?(y=S.height*(1-bq)+S.y,g="north"):F>=45&&135>F?(C=S.width*(1-bq)+S.x,g="west"):F>=135&&225>F?(y=S.height*bq+S.y,g="south"):(C=S.width*bq+S.x,g="east"):"northwest"===Z?F>=315||45>F?(C=S.width*(1-Qk)+S.x,y=S.height*(1-bq)+S.y,g="northwest"):F>=45&&135>F?(C=S.width*(1-bq)+S.x,y=S.height*Qk+S.y,g="southwest"):F>=135&&225>F?(C=S.width*Qk+S.x,y=S.height*bq+S.y,g="southeast"):(C=S.width*bq+S.x,y=S.height*(1-Qk)+S.y,g="northeast"):"west"===Z?F>=315||45>F?(C=S.width*(1-Qk)+S.x,g="west"):F>=45&&135>F?(y=S.height*Qk+S.y,g="south"):F>=135&&225>F?(C=S.width*Qk+S.x,g="east"):(y=S.height*(1-Qk)+S.y,g="north"):"southwest"===Z?F>=315||45>F?(C=S.width*(1-Qk)+S.x,y=S.height*bq+S.y,g="southwest"):F>=45&&135>F?(C=S.width*bq+S.x,y=S.height*Qk+S.y,g="southeast"):F>=135&&225>F?(C=S.width*Qk+S.x,y=S.height*(1-bq)+S.y,g="northeast"):(C=S.width*(1-bq)+S.x,y=S.height*(1-Qk)+S.y,g="northwest"):"east"===Z?F>=315||45>F?(C=S.width*Qk+S.x,g="east"):F>=45&&135>F?(y=S.height*(1-Qk)+S.y,g="north"):F>=135&&225>F?(C=S.width*(1-Qk)+S.x,g="west"):(y=S.height*Qk+S.y,g="south"):"south"===Z?F>=315||45>F?(y=S.height*bq+S.y,g="south"):F>=45&&135>F?(C=S.width*bq+S.x,g="east"):F>=135&&225>F?(y=S.height*(1-bq)+S.y,g="north"):(C=S.width*(1-bq)+S.x,g="west"):"southeast"===Z&&(F>=315||45>F?(C=S.width*Qk+S.x,y=S.height*bq+S.y,g="southeast"):F>=45&&135>F?(C=S.width*bq+S.x,y=S.height*(1-Qk)+S.y,g="northeast"):F>=135&&225>F?(C=S.width*(1-Qk)+S.x,y=S.height*(1-bq)+S.y,g="northwest"):(C=S.width*(1-bq)+S.x,y=S.height*Qk+S.y,g="southwest"));var D=Ck(l,C-l.x,y-l.y,N.getRotation());vh(N,S,g,{x:D.x,y:D.y});var x=Aq+O.width*I.x,G=on+O.height*I.y,d={x:x,y:G};d=Ck({x:ok,y:mb},d.x-ok,d.y-mb,t),N.p(d.x,d.y)}}),b.fi({kind:"betweenEditRect",event:T,direction:Z})}else if(b.$23l&&b.$40l){var Te=b.$8l,ab=Te.width,Do=Te.height,e={x:Te.x+ab/2,y:Te.y+Do/2},_=b.$24l,qk=b.$23l,Le=qk.x/P-e.x,Kl=qk.y/P-e.y,hp=V(Le*Le+Kl*Kl),Ai=Math.asin(_.x/hp),bi=E.sm().getSelection(),$q=n+B(d.y-e.y,d.x-e.x)-Ai,Zj=E.getSnapAngle(),$q=$($q/Zj)*Zj;0>$q&&($q+=v);var sq=$q-b.$7l,hj=[e.x,0,e.y];bi.each(function(n){if(E.isEditable(n)&&E.isRotationEditable(n)&&E.isVisible(n)){var q=op(n.p3(),hj),w=Sp();rr(w,-sq),n.setRotation(n.getRotation()+sq),Kf(q,w),n.p3(hj[0]+q[0],hj[1]+q[1],hj[2]+q[2])}}),b.$7l=$q,b.fi({kind:"betweenEditRotation",event:T})}else if([1,2,3,5,6].indexOf(b.$67l)>=0)b.$72l=T,b.$78l||(b.$78l=1,r(function(){q.isDragging()&&b.$43l(),delete b.$78l},12));else if(7===b.$67l){if(b.$87l instanceof W){var L=b.$87l,Th=b.$88l,ze=q.clone(L.getPoints().get(Th)),kc=d.y-ze.y;ze.e||(ze.e=0),b.$92l||(b.$92l=ze.e),ze.e=b.$92l-kc,L.setPoint(Th,ze)}else if(b.$87l instanceof h){var U=b.$87l,Th=b.$88l,D=Ln(E.getDataUI(U),U.s("edge.points")),ze=D.get(Th),kc=d.y-ze.y;ze.e||(ze.e=0),b.$92l||(b.$92l=ze.e),ze.e=b.$92l-kc,D.set(Th,ze),U.s("edge.points",lj(D))}}else if(8===b.$67l){var bi=E.sm().getSelection(),rg=b.$93l;rg||(rg=b.$93l={}),bi.each(function(Z){if(Z.p3){var w=Z.p3(),a=rg[Z.getId()];a==i&&(a=rg[Z.getId()]=w[1]),Z.p3([w[0],a-(d.y-b.$90l.y/P),w[2]])}})}else if(9===b.$67l){var bi=E.sm().getSelection(),js=b.$94l;js||(js=b.$94l={}),bi.each(function(E){if(E.s3){var s=E.s3(),w=js[E.getId()];w==i&&(w=js[E.getId()]=s[1]);var Q=w-(d.y-b.$91l.y/P);0>Q&&(Q=.01),E.s3([s[0],Q,s[2]])}})}},$79l:function(O,q){var T=this,p=T.gv,d=p.getZoom(),b=p.getEditHelperSize(),S=O.x/d,m=O.y/d,t=b/d,h=t/2;return k({x:S-h,y:m-h,width:t,height:t},q)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(m,r){for(var N=this,R=N.gv,q=R.getZoom(),H=R.getEditPointSize(),e=H/q,C=e/2,n=N.$46l(m),u=0;u<n.length;u++){var $,l,g=n[u],T=R.getDataUI(g);if(T&&T._55O){var O=T._55O;if(O._43O&&g instanceof h){if($=g.s("edge.points"),$=Ln(T,$),l=g.s("edge.segments"),l&&l.size()||(l=Oj($)),N.$42l(g,r,$._as,l,"edge"))return!0;if("points"===g.s("edge.type")&&N.$41l(g,r,$._as,l,"edge"))return}if(O._43O&&g instanceof W&&O.$15l&&O.$15l.length===g.getPoints().size()){if($=O.$15l,l=g.getSegments(),l&&l.size()||(l=Oj($)),N.$42l(g,r,$,l,"shape"))return!0;if(N.$41l(g,r,$,l,"shape"))return}}}if(N.$16l){var $,I=N.$16l,P=I[3].x-I[7].x,Y=I[3].y-I[7].y,S=V(P*P+Y*Y),v=I[1].x-I[5].x,Z=I[1].y-I[5].y,b=V(v*v+Z*Z),A={x:r.x*q,y:r.y*q};if(N._80I(A,0,I[0],"northwest",S,b)||N._80I(A,1,I[1],"north",S,b)||N._80I(A,2,I[2],"northeast",S,b)||N._80I(A,7,I[7],"west",S,b)||N._80I(A,3,I[3],"east",S,b)||N._80I(A,6,I[6],"southwest",S,b)||N._80I(A,5,I[5],"south",S,b)||N._80I(A,4,I[4],"southeast",S,b))return!0}if(N.$23l){var s=N.$23l,B=s.x/q,j=s.y/q;if(k({x:B-C,y:j-C,width:e,height:e},r))return N.$40l=1,N.$12l=N.getHelperCursor("rotation")||"crosshair",!0}return N.$68l&&N.$79l(N.$68l,r)?(N.$67l=1,N.$12l=N.getHelperCursor("host")||"crosshair",!0):N.$69l&&N.$79l(N.$69l,r)?(N.$67l=2,N.$12l=N.getHelperCursor("parent")||"crosshair",!0):N.$70l&&N.$79l(N.$70l,r)?(N.$67l=3,N.$12l=N.getHelperCursor("edge")||"crosshair",!0):N.$71l&&N.$79l(N.$71l,r)?(N.$67l=4,N.$12l=N.getHelperCursor("remove")||"crosshair",!0):N.$82l&&N.$79l(N.$82l,r)?(N.$67l=5,N.$12l=N.getHelperCursor("source")||"crosshair",!0):N.$83l&&N.$79l(N.$83l,r)?(N.$67l=6,N.$12l=N.getHelperCursor("target")||"crosshair",!0):N._pointElevationHelperPoint&&N.$79l(N._pointElevationHelperPoint,r)?(N.$67l=7,N.$12l=N.getHelperCursor("pointElevation")||"crosshair",!0):N.$90l&&N.$79l(N.$90l,r)?(N.$67l=8,N.$12l=N.getHelperCursor("elevation")||"crosshair",!0):N.$91l&&N.$79l(N.$91l,r)?(N.$67l=9,N.$12l=N.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(v,T,J,p,E,Z){var b=this,H=b.gv,R=H.getEditPointSize(),i=R/2,V=H.sm(),r=H.isDirectionEditable;if(r&&1===V.size()){var y=V.ld();if(r=r.bind(H),y instanceof c){if(!r(y,p))return!1;if("east"===p){if(r(y,"northeast")&&r(y,"southeast")&&2*R>=Z)return!1}else if("west"===p){if(r(y,"northwest")&&r(y,"southwest")&&2*R>=Z)return!1}else if("north"===p){if(r(y,"northwest")&&r(y,"northeast")&&2*R>=E)return!1}else if("south"===p&&r(y,"southwest")&&r(y,"southeast")&&2*R>=E)return!1}}else{if(2*R>=E&&("north"===p||"south"===p))return!1;if(2*R>=Z&&("east"===p||"west"===p))return!1}if(k({x:J.x-i,y:J.y-i,width:R,height:R},v)){if(b.$10l!==p){var X=180*b.$7l/Y,f="";X>=337.5||22.5>X?f="north":X>=22.5&&67.5>X?f="northeast":X>=67.5&&112.5>X?f="east":X>=112.5&&157.5>X?f="southeast":X>=157.5&&202.5>X?f="south":X>=202.5&&247.5>X?f="southwest":X>=247.5&&292.5>X?f="west":X>=292.5&&337.5>X&&(f="northwest");var l=yf.indexOf(f),f=yf[T-(1-l)+8];switch(f){case"northwest":b.$12l="nwse-resize";break;case"northeast":b.$12l="nesw-resize";break;case"southwest":b.$12l="nesw-resize";break;case"southeast":b.$12l="nwse-resize";break;case"north":b.$12l="ns-resize";break;case"east":b.$12l="ew-resize";break;case"south":b.$12l="ns-resize";break;case"west":b.$12l="ew-resize"}b.$10l=p}return!0}return!1},$42l:function(w,n,R,N,H){var C,u=this,I=u.gv,O=I.getEditPointSize(),o=O/I.getZoom(),S=-1,p={x:n.x,y:n.y,width:0,height:0},x=function(h){"shape"===H?u._shape=w:u._edge=w,u._removePointIndex=h},y=function(c){"shape"===H?u._shape=w:u._edge=w,u.$13l=c,u.$12l="crosshair"};for(U(p,o/2),S=R.length-1,C=N.size()-1;C>=0;C--){var L=N.get(C);if(1===L||2===L)S-=1;else if(3===L){var B=R[S-1];if(k(p,B))return y(S-1),!0;S-=2}else if(4===L){var j=R[S-1],E=R[S-2];if(k(p,j))return y(S-1),!0;if(k(p,E))return y(S-2),!0;S-=3}}for(S=R.length-1,C=N.size()-1;C>=0;C--){var L=N.get(C),f=R[S];if(k(p,f))return x(S),y(S),!0;1===L||2===L?S-=1:3===L?S-=2:4===L&&(S-=3)}return!1},$41l:function(H,N,o,x,R){var e=this,X=e.gv,h=-1,T=0,v={x:N.x,y:N.y,width:0,height:0},$=function(D,u){e._hoverSegmentIndex=u,e._lp=N,"shape"===R?e._shape=H:e._edge=H};for(U(v,X.getSegmentHoverWidth()/2/X.getZoom()),H instanceof W&&H.isClosePath()&&x.indexOf(5)<0&&(x=new j(x._as),x.add(5));T<x.size();T++){var s=x.get(T);if(1===s){var E=o[h],O=o[h+1];if(E){var Z=kd(new Lb(E.x,E.y),new Lb(O.x,O.y),new Lb(v.x,v.y),new Lb(v.x+v.width,v.y+v.height));if(Z.$62l===P&&Z.points.length>0)return $(Z,T),!0}h+=1}else if(2===s){var E=o[h],O=o[h+1],Z=kd(new Lb(E.x,E.y),new Lb(O.x,O.y),new Lb(v.x,v.y),new Lb(v.x+v.width,v.y+v.height));if(Z.$62l===P&&Z.points.length>0)return $(Z,T),!0;h+=1}else if(3===s){var E=o[h],B=o[h+1],i=o[h+2],Z=Yn(new Lb(E.x,E.y),new Lb(B.x,B.y),new Lb(i.x,i.y),new Lb(v.x,v.y),new Lb(v.x+v.width,v.y+v.height));if(Z.$62l===P)return $(Z,T),!0;h+=2}else if(4===s){var E=o[h],V=o[h+1],p=o[h+2],i=o[h+3],Z=Gc(new Lb(E.x,E.y),new Lb(V.x,V.y),new Lb(p.x,p.y),new Lb(i.x,i.y),new Lb(v.x,v.y),new Lb(v.x+v.width,v.y+v.height));if(Z.$62l===P)return $(Z,T),!0;h+=3}else if(5===s){var E=o[h],O=o[0];if(E){var Z=kd(new Lb(E.x,E.y),new Lb(O.x,O.y),new Lb(v.x,v.y),new Lb(v.x+v.width,v.y+v.height));if(Z.$62l===P&&Z.points.length>0)return $(Z,T),!0}}}return!1},addShapePoint:function(x,H,n){var L=this,Z=L.gv,i=Z.dm();if(i.beginTransaction(),0===arguments.length&&(x=L._shape||L._edge,H=L._hoverSegmentIndex,n=L._lp),x instanceof W||x instanceof h){var I=sr(x,Z.getDataUI(x),H);if(!isNaN(H)&&n&&!isNaN(I)){var E=n;if(x instanceof W){var F=x.p(),X=x.getRotation(),g=x.toSegments();g&&g.size()||(g=Oj(x.getPoints())),x.isClosePath()&&g.indexOf(5)<0&&(g=new j(g._as),g.add(5));var S=g.get(H),O="addPoint",p="removePointAt";if(2===S||1===S){var f={x:E.x,y:E.y};g.add(S,H),f=Ck(F,f.x-F.x,f.y-F.y,-X),x[O](f,I+1)}else if(3===S){var U=x.getPoints(),G=U.get(I),t=U.get(I+2),f={x:E.x,y:E.y};f=Ck(F,f.x-F.x,f.y-F.y,-X);var b=tr(G,f),K=tr(f,t);g.removeAt(H),g.add(3,H),g.add(3,H),x.setPoint(I+1,f),x[O](K,I+2),x[O](b,I+1)}else if(4===S){var U=x.getPoints(),G=U.get(I),t=U.get(I+3),f={x:E.x,y:E.y};f=Ck(F,f.x-F.x,f.y-F.y,-X);var b=Ig(G,f),K=Fj(G,f),e=Ig(f,t),N=Fj(f,t);g.removeAt(H),g.add(4,H),g.add(4,H),x[p](I+1),x[p](I+1),x[O](f,I+1),x[O](N,I+2),x[O](e,I+2),x[O](K,I+1),x[O](b,I+1)}else if(5===S){var f={x:E.x,y:E.y};g.add(2,H),f=Ck(F,f.x-F.x,f.y-F.y,-X),x[O](f,I+1)}x.isClosePath()&&g.remove(5),x.setSegments(g);var C=x.getWidth(),Y=x.getHeight(),w=x.p().x-C/2,z=x.p().y-Y/2;w-=F.x,z-=F.y;var Q=Xo(x,{x:w,y:z,width:C,height:Y},X,F);x.p(Q.x,Q.y)}else if(x instanceof h){if("points"!==x.s("edge.type"))return i.endTransaction(),void 0;var U=x.s("edge.points");g=x.s("edge.segments"),U=Ln(Z.getDataUI(x),U),g&&g.size()||(g=Oj(U)),g=new j(g._as.slice(0)),U=new j(U._as.slice(0));var S=g.get(H);if(2===S||1===S){var f={x:E.x,y:E.y};g.add(S,H),U.add(f,I+1)}else if(3===S){var G=U.get(I),t=U.get(I+2),f={x:E.x,y:E.y},b=tr(G,f),K=tr(f,t);g.removeAt(H),g.add(3,H),g.add(3,H),U.set(I+1,f),U.add(K,I+2),U.add(b,I+1)}else if(4===S){var G=U.get(I),t=U.get(I+3),f={x:E.x,y:E.y},b=Ig(G,f),K=Fj(G,f),e=Ig(f,t),N=Fj(f,t);g.removeAt(H),g.add(4,H),g.add(4,H),U.removeAt(I+1),U.removeAt(I+1),U.add(f,I+1),U.add(N,I+2),U.add(e,I+2),U.add(K,I+1),U.add(b,I+1)}x.s("edge.points",lj(U)),x.s("edge.segments",g)}}}i.endTransaction()},removeShapePoint:function(T,x){var M=this,N="removeAt",d=M.gv,Y=d.dm();if(Y.beginTransaction(),0===arguments.length&&(T=M._shape||M._edge,x=M._removePointIndex),x>=0&&(T instanceof W||T instanceof h)){var t=Mb(T,M.gv.getDataUI(T),x),o=x;if(T instanceof W){var C=T.p(),S=T.toSegments();S&&S.size()||(S=Oj(T.getPoints()));var J=S.get(t),k="removePointAt";if(1===J&&0===o)if(T.getPoints().size()>1){var E=S.get(t+1);S[N](t+1),3===E?T[k](o+1):4===E&&(T[k](o+2),T[k](o+1)),T[k](o)}else T.dm().remove(T);else 2===J||1===J?(S[N](t),T[k](o)):3===J?(S[N](t),T[k](o),T[k](o-1)):4===J&&(S[N](t),T[k](o),T[k](o-1),T[k](o-2));T.setSegments(S);var f=T.getWidth(),R=T.getHeight(),i=T.p().x-f/2,m=T.p().y-R/2;i-=C.x,m-=C.y;var F=Xo(T,{x:i,y:m,width:f,height:R},T.getRotation(),C);T.p(F.x,F.y)}else if(T instanceof h){if("points"!==T.s("edge.type"))return Y.endTransaction(),void 0;var I=T.s("edge.points");if(S=T.s("edge.segments"),I&&(I=Ln(M.gv.getDataUI(T),I),S&&S.size()||(S=Oj(I))),0===x||x===I.size()-1)return Y.endTransaction(),void 0;S=new j(S._as.slice(0)),I=new j(I._as.slice(0));var J=S.get(t);2===J||1===J?(S[N](t),I[N](o)):3===J?(S[N](t),I[N](o),I[N](o-1)):4===J&&(S[N](t),I[N](o),I[N](o-1),I[N](o-2)),T.s("edge.segments",S),T.s("edge.points",lj(I))}}Y.endTransaction()},changeShapeSegment:function(r,C,L){var S=this,w=S.gv,B=w.dm();if(B.beginTransaction(),1!==arguments.length||isNaN(r)||(L=r,r=S._shape||S._edge,C=S._hoverSegmentIndex),r instanceof W||r instanceof h){var R=sr(r,S.gv.getDataUI(r),C);if(!isNaN(C)&&!isNaN(R))if(r instanceof W){var E=r.p(),f=r.toSegments();f&&f.size()||(f=Oj(r.getPoints()));var p=f.get(C),X=r.toPoints();if(1===L||2===L)1===p||2===p?f.set(C,L):3===p?(f.set(C,L),X.removeAt(R+1)):4===p&&(f.set(C,L),X.removeAt(R+1),X.removeAt(R+1));else if(3===L){var N=function(){var Z=X.get(R),h=X.get(R+1),G=tr(Z,h);f.set(C,3),X.add(G,R+1)};2===p||1===p?N():4===p&&(X.removeAt(R+1),X.removeAt(R+1),N())}else if(4===L){var v=function(){var g=X.get(R),P=X.get(R+1),c=Ig(g,P),Y=Fj(g,P);f.set(C,4),X.add(c,R+1),X.add(Y,R+2)};2===p||1===p?v():3===p&&(X.removeAt(R+1),v())}r.setSegments(f),r.setPoints(X);var b=r.getWidth(),D=r.getHeight(),s=r.p().x-b/2,T=r.p().y-D/2;s-=E.x,T-=E.y;var m=new Xo(r,{x:s,y:T,width:b,height:D},r.getRotation(),E);r.p(m.x,m.y)}else if(r instanceof h){if("points"!==r.s("edge.type"))return B.endTransaction(),void 0;var X=r.s("edge.points");f=r.s("edge.segments"),X&&(X=Ln(S.gv.getDataUI(r),X),f&&f.size()||(f=Oj(X))),f=new j(f._as.slice(0)),X=new j(X._as.slice(0));var p=f.get(C);if(1===L||2===L)1===p||2===p?f.set(C,L):3===p?(f.set(C,L),X.removeAt(R+1)):4===p&&(f.set(C,L),X.removeAt(R+1),X.removeAt(R+1));else if(3===L){var N=function(){var H=X.get(R),Q=X.get(R+1),S=tr(H,Q);f.set(C,3),X.add(S,R+1)};2===p||1===p?N():4===p&&(X.removeAt(R+1),X.removeAt(R+1),N())}else if(4===L){var v=function(){var d=X.get(R),V=X.get(R+1),y=Ig(d,V),m=Fj(d,V);f.set(C,4),X.add(y,R+1),X.add(m,R+2)};2===p||1===p?v():3===p&&(X.removeAt(R+1),v())}r.s("edge.points",lj(X)),r.s("edge.segments",f)}}B.endTransaction()},getDefaultSegments:function(B){var K=this.gv,X=K.getDataUI(B);if(B instanceof h){var q=B.s("edge.points");return q=Ln(X,q),Oj(q)}if(B instanceof W){var q=B.getPoints(),v=B.getSegments();return v&&v.size()>0?v:Oj(q)}},$43l:function(H){var C=this;H&&(C.$5l=1),C._68I=1,C._42()},_42:function(){var G=this;if(G._68I){delete G._68I;var z=G.gv,D=G.$5l,b=z.getZoom(),L=z.getEditPointSize(),p=L/2,M=new j,t=G._view,T=G._edge,k=G._shape,Z=t.getContext("2d"),y=z.tx(),K=z.ty(),F=i,r=z.getEditPointBackground(),E=z.getControlPointBackground(),o=z.getControlPointBorderColor(),C=z.getEditPointBorderColor(),f=z.getEditRectBorderColor(),l=z.getDirectionLineColor(),N=z.getSegmentHoverColor(),$=z.getSnapPointBorderColor(),g=z.getJoinPointBackground(),x=z.getJoinPointBorderColor(),I=z.getSegmentHoverWidth(),P=[5,5],B=z.getEditRectBorderStyle();yb(z,function(F){z.isSelected(F)&&z.isVisible(F)&&M.add(F)}),Z.clearRect(0,0,e(t.width),e(t.height)),Z.save(),X.translateAndScale(Z,y,K,1);var A=i,s={x:0,y:0,width:0,height:0},w=0,Y=0,O=0,a=0,H=0,n=0,xk=0,kr=0,Rf=0,Wr=0,ii=[];if(D?(delete G.$6l,delete G.$8l,delete G.$7l,delete G.$16l,delete G.$23l):(A=G.$6l,F=G.$7l),delete G.$68l,delete G.$69l,delete G.$71l,delete G.$70l,delete G.$82l,delete G.$83l,delete G._pointElevationHelperPoint,delete G.$90l,delete G.$91l,delete G.$75l,delete G.$74l,M.each(function(B){var N=z.getDataUI(B);if(N){var G=N._55O;if(z.isEditable(B))G._56O&&B instanceof c&&Y++,ii.push(B),G._42O&&B instanceof c&&w++,z.isHelperEditable(B,"host")&&a++,z.isHelperEditable(B,"parent")&&O++,z.isHelperEditable(B,"remove")&&H++,z.isHelperEditable(B,"edge")&&n++,z.isHelperEditable(B,"source")&&xk++,z.isHelperEditable(B,"target")&&kr++,z.isHelperEditable(B,"elevation")&&Rf++,z.isHelperEditable(B,"tall")&&Wr++;else if(B instanceof m&&B.isExpanded()){var u=!0,E=z.getEditableFunc();E&&(u=E(B)),u&&(z.isHelperEditable(B,"host")&&a++,z.isHelperEditable(B,"parent")&&O++,z.isHelperEditable(B,"remove")&&H++,z.isHelperEditable(B,"edge")&&n++,z.isHelperEditable(B,"source")&&xk++,z.isHelperEditable(B,"target")&&kr++,z.isHelperEditable(B,"elevation")&&Rf++,z.isHelperEditable(B,"tall")&&Wr++,ii.push(B))}}}),Z.beginPath(),Z.lineWidth=1,Z.strokeStyle=z.getNodeBorderColor(),ii.forEach(function(k){var M=z.getDataUI(k),u=M._55O;if(D)if(F==i&&(F=k instanceof h?0:k instanceof m&&k.isExpanded()?0:k.getRotation(),G.$7l=F),A==i){var C,y,B;if(k instanceof m&&k.isExpanded()||k instanceof h){var f=z.getDataUIBounds(k);y=f.width,B=f.height,C={x:f.x+y/2,y:f.y+B/2}}else C=k.p(),y=k.getWidth(),B=k.getHeight();A={x:C.x,y:C.y,width:0,height:0},s.x=C.x-y/2,s.y=C.y-B/2,s.width=y,s.height=B,A=S(A,s)}else{var C,y,B,$,r=A.x+A.width/2,x=A.y+A.height/2,j={x:r,y:x};if(k instanceof m&&k.isExpanded()||k instanceof h){$=0;var f=z.getDataUIBounds(k);y=f.width,B=f.height,C={x:f.x+y/2,y:f.y+B/2}}else C=k.p(),y=k.getWidth(),B=k.getHeight(),$=k.getRotation();var N={x:C.x-y/2,y:C.y-B/2,width:y,height:B},L={x:N.x,y:N.y},d={x:N.x+N.width,y:N.y},U={x:N.x,y:N.y+N.height},n={x:N.x+N.width,y:N.y+N.height},L=Ck(C,L.x-C.x,L.y-C.y,$),U=Ck(C,U.x-C.x,U.y-C.y,$),n=Ck(C,n.x-C.x,n.y-C.y,$),d=Ck(C,d.x-C.x,d.y-C.y,$),O=-F,X=Ck(j,L.x-j.x,L.y-j.y,O),a=Ck(j,d.x-j.x,d.y-j.y,O),Q=Ck(j,U.x-j.x,U.y-j.y,O),l=Ck(j,n.x-j.x,n.y-j.y,O),q=R([X,a,Q,l]);A=S(A,q),A.x-=r,A.y-=x;var T=Xo(i,A,F,j);A.x=T.x-A.width/2,A.y=T.y-A.height/2}if(w>1&&z.isEditable(k)&&z.isRectEditable(k)&&k instanceof c){var E=k.getRect(),e=u.$45l,V=Rj(e[0],b),W=Rj(e[2],b),K=Rj(e[4],b),_=Rj(e[6],b);k.getRotation()?(Z.moveTo(V.x,V.y),Z.lineTo(W.x,W.y),Z.lineTo(K.x,K.y),Z.lineTo(_.x,_.y),Z.lineTo(V.x,V.y)):Z.rect(E.x*b,E.y*b,E.width*b,E.height*b)}}),Z.stroke(),A){G.$6l=_(A),U(A,z.getEditRectPadding()/b);var on={x:A.x+A.width/2,y:A.y+A.height/2},cr=vf(on,A.width,A.height,F),hi=cr[0],fe=cr[1],Qk=cr[2],zs=cr[3],Ll=cr[4],Fj=cr[5],Vq=cr[6],Qh=cr[7];if(hi=Rj(cr[0],b),fe=Rj(cr[1],b),Qk=Rj(cr[2],b),zs=Rj(cr[3],b),Ll=Rj(cr[4],b),Fj=Rj(cr[5],b),Vq=Rj(cr[6],b),Qh=Rj(cr[7],b),G.$8l=A,w>0&&(G.$16l=[hi,Ll,fe,Fj,zs,Vq,Qk,Qh],Z.beginPath(),Z.lineWidth=1,Z.strokeStyle=f,"dashed"===B&&Z.setLineDash&&Z.setLineDash(P),Z.moveTo(hi.x,hi.y),Z.lineTo(fe.x,fe.y),Z.lineTo(zs.x,zs.y),Z.lineTo(Qk.x,Qk.y),Z.lineTo(hi.x,hi.y),Z.stroke(),"dashed"===B&&Z.setLineDash&&Z.setLineDash([])),Z.beginPath(),Z.lineWidth=1,Z.fillStyle=r,Z.strokeStyle=C,w>0){var jb=Fj.x-Qh.x,Xm=Fj.y-Qh.y,Xr=V(jb*jb+Xm*Xm),Sj=Ll.x-Vq.x,Yq=Ll.y-Vq.y,aj=V(Sj*Sj+Yq*Yq),xg=2*L;if(z.isDirectionEditable&&1===ii.length){var nf=ii[0],Mq=z.getDataUI(nf),Xp=Mq._55O,sq=z.isDirectionEditable.bind(z);if(Xp._42O){var Nr,Tk,he,hb;sq(nf,"northwest")&&(Nr=!0,Z.rect(hi.x-p,hi.y-p,L,L)),sq(nf,"northeast")&&(Tk=!0,Z.rect(fe.x-p,fe.y-p,L,L)),sq(nf,"southwest")&&(he=!0,Z.rect(Qk.x-p,Qk.y-p,L,L)),sq(nf,"southeast")&&(hb=!0,Z.rect(zs.x-p,zs.y-p,L,L)),sq(nf,"north")&&(Nr&&Tk?Xr>xg&&Z.rect(Ll.x-p,Ll.y-p,L,L):Z.rect(Ll.x-p,Ll.y-p,L,L)),sq(nf,"south")&&(hb&&he?Xr>xg&&Z.rect(Vq.x-p,Vq.y-p,L,L):Z.rect(Vq.x-p,Vq.y-p,L,L)),sq(nf,"west")&&(he&&Nr?aj>xg&&Z.rect(Qh.x-p,Qh.y-p,L,L):Z.rect(Qh.x-p,Qh.y-p,L,L)),sq(nf,"east")&&(hb&&Tk?aj>xg&&Z.rect(Fj.x-p,Fj.y-p,L,L):Z.rect(Fj.x-p,Fj.y-p,L,L))}}else Xr>xg&&(Z.rect(Ll.x-p,Ll.y-p,L,L),Z.rect(Vq.x-p,Vq.y-p,L,L)),aj>xg&&(Z.rect(Fj.x-p,Fj.y-p,L,L),Z.rect(Qh.x-p,Qh.y-p,L,L)),Z.rect(hi.x-p,hi.y-p,L,L),Z.rect(fe.x-p,fe.y-p,L,L),Z.rect(Qk.x-p,Qk.y-p,L,L),Z.rect(zs.x-p,zs.y-p,L,L)}if(Y>0){var Cb=G.$23l=Ck(Ll,0,2*-L,F);Z.moveTo(Cb.x+p,Cb.y),Z.arc(Cb.x,Cb.y,p,0,v,!1)}Z.fill(),Z.stroke(),G.$40l&&G.$44l(Z,A,F);var Nk,Dr,le=z.getLeftTopHelpers(),Qo=z.getRightTopHelpers(),Eq=z.getLeftBottomHelpers(),Pj=z.getRightBottomHelpers(),Qr=z.getEdgeHelpers(),Kl=z.getEditHelperSize(),Mr=Kl/2,Id=function(R,J,I,u){"leftTop"===J?(Nk=A.x*b-Kl-p-("h"===u?I*(Kl+p):0)-1,Dr=A.y*b-Kl-p-("v"===u?I*(Kl+p):0)-1):"rightTop"===J?(Nk=(A.x+A.width)*b+p+("h"===u?I*(Kl+p):0)+1,Dr=A.y*b-Kl-p-("v"===u?I*(Kl+p):0)-1):"leftBottom"===J?(Nk=A.x*b-Kl-p-("h"===u?I*(Kl+p):0)-1,Dr=(A.y+A.height)*b+p+("v"===u?I*(Kl+p):0)+1):"rightBottom"===J&&(Nk=(A.x+A.width)*b+p+("h"===u?I*(Kl+p):0)+1,Dr=(A.y+A.height)*b+p+("v"===u?I*(Kl+p):0)+1);var r=Nk+Mr,Q=Dr+Mr,N=(A.x+A.width/2)*b,s=(A.y+A.height/2)*b,e=Ck({x:N,y:s},r-N,Q-s,F);if("host"===R){if(a>0)return G.$77l(Z,F,e),!0}else if("edge"===R){if(n>0)return G.$80l(Z,F,e),!0}else if("remove"===R){if(H>0)return ii&&1===ii.length&&ii[0]instanceof h?G.$81l(Z,F,{x:N+Kl/2+5,y:s}):G.$81l(Z,F,e),!0}else if("parent"===R){if(O>0)return ii&&1===ii.length&&ii[0]instanceof h?G.$76l(Z,F,{x:N-Kl/2-5,y:s}):G.$76l(Z,F,e),!0}else if("elevation"===R){if(Rf>0)return G.$85l(Z,F,e),!0}else if("tall"===R){if(Wr>0)return G.$86l(Z,F,e),!0}else if("source"===R||"target"===R){var Y=ii[0],k=z.getDataUI(Y),D=Do(k,!0),M=D[0],g=D[1];if(xk&&"source"===R)return G.$84l(Z,A,M,!0,Y.isLooped(),J,I,u),!0;if(kr&&"target"===R)return G.$84l(Z,A,g,!1,Y.isLooped(),J,I,u),!0}};if(le&&le.length>0){var jq=0;le.forEach(function($){Id($,"leftTop",jq,z.getLeftTopHelpersAlign()||"h")&&jq++})}if(Qo&&Qo.length>0){var jq=0;Qo.forEach(function(U){Id(U,"rightTop",jq,z.getRightTopHelpersAlign()||"h")&&jq++})}if(Eq&&Eq.length>0){var jq=0;Eq.forEach(function(r){Id(r,"leftBottom",jq,z.getLeftBottomHelpersAlign()||"h")&&jq++})}if(Pj&&Pj.length>0){var jq=0;Pj.forEach(function(f){Id(f,"rightBottom",jq,z.getRightBottomHelpersAlign()||"h")&&jq++})}if(Qr&&Qr.length>0&&((xk||kr)&&ii&&1===ii.length&&ii[0]instanceof h?!0:!1)){var jq=0;Qr.forEach(function(A){Id(A,"edge",jq,"h")&&jq++})}if(G.$72l){var rg,_r=G.$67l,Cl=G.$68l,Bn=G.$69l,Jk=(G.$71l,G.$70l),ek=G.$82l,Hh=G.$83l;if(1===_r?rg=Cl:2===_r?rg=Bn:3===_r?rg=Jk:5===_r?rg=ek:6===_r&&(rg=Hh),rg){var ld=z.lp(G.$72l),Vr=z.getDataAt(G.$72l);if(Vr&&Vr instanceof c){var We,em,ug;if(G.$73l=Vr,1===_r)if(Vr instanceof J.Grid)We=G.$75l=pi(Vr,ld);else if(Vr instanceof J.Shape){ug=G.$74l=np(Vr,ld);var Eg=Vr.getPoints();if(ug){var zr=ug.attachIndex,ym=sr(Vr,z.getDataUI(Vr),zr)+1,wj=ym+1>=Eg.size()?0:ym+1,$c=Eg.get(ym),Ph=Eg.get(wj),Il=Vr.p(),Gr=Vr.getRotation();$c=Ck(Il,$c.x-Il.x,$c.y-Il.y,Gr),Ph=Ck(Il,Ph.x-Il.x,Ph.y-Il.y,Gr),Z.beginPath(),Z.strokeStyle=N,Z.lineWidth=I,Z.moveTo($c.x*b,$c.y*b),Z.lineTo(Ph.x*b,Ph.y*b),Z.stroke()}}We?em=We.rect:(em=q.clone(z.getDataUIBounds(Vr)),q.grow(em,2)),Z.beginPath(),Z.rect(em.x*b,em.y*b,em.width*b,em.height*b),Z.strokeStyle=1===_r||4===_r||6===_r?d:u,Z.lineWidth=2,Z.setLineDash&&Z.setLineDash([8,8]),Z.stroke()}else delete G.$73l;ld.x=ld.x*b,ld.y=ld.y*b;var rm=wf(rg.x,rg.y,ld.x,ld.y),Yo=Ck(rg,ld.x-rg.x,ld.y-rg.y,-rm),Nq=Yo.x-rg.x;Z.save(),Z.translate(rg.x,rg.y),Z.rotate(rm),Q.width=Nq,Q.height=40;var $k=u;(1===_r||4===_r||6===_r)&&($k=d),Q.comps[0].gradientColor=$k,q.drawImage(Z,Q,0,-20,Nq,40),Z.restore()}}}if(M.each(function(y){var s=z.getDataUI(y);if(s){var O,F,S=s._55O,h=s._78o;if(S&&S._43O&&y instanceof W?(O=S.$15l,F=y.getSegments(),F&&F.size()||(F=Oj(O)),y.isClosePath()&&F.indexOf(5)<0&&(F=new j(F._as),F.add(5))):S&&h&&S._43O&&(O=y.s("edge.points"),F=y.s("edge.segments"),O=Ln(s,O),F&&F.size()||(F=Oj(O)),O&&(O=O._as)),O&&F){var r=0,t=F.size(),d=G._hoverSegmentIndex;O=O.slice(0);for(var m=0;m<O.length;m++)O[m]=Rj(O[m],b);Z.beginPath(),Z.strokeStyle=l,Z.lineWidth=1,r=0;for(var m=0;t>m;m++){var U=F.get(m);if(1===U||2===U)r++;else if(3===U){var R=O[r-1],w=O[r],n=O[r+1];Z.moveTo(R.x,R.y),Z.lineTo(w.x,w.y),Z.lineTo(n.x,n.y),r+=2}else if(4===U){var R=O[r-1],L=O[r],D=O[r+1],n=O[r+2];Z.moveTo(R.x,R.y),Z.lineTo(L.x,L.y),Z.moveTo(D.x,D.y),Z.lineTo(n.x,n.y),r+=3}}if(Z.stroke(),k===y||T===y&&"points"===T.s("edge.type")){Z.beginPath(),r=0,Z.strokeStyle=N,Z.lineWidth=I;for(var m=0;t>m;m++){var U=F.get(m);if(1===U||2===U){if(d===m){var R=O[r-1],n=O[r];Z.moveTo(R.x,R.y),Z.lineTo(n.x,n.y);break}r++}else if(3===U){if(d===m){var R=O[r-1],w=O[r],n=O[r+1];Z.moveTo(R.x,R.y),Z.quadraticCurveTo(w.x,w.y,n.x,n.y);break}r+=2}else if(4===U){if(d===m){var R=O[r-1],L=O[r],D=O[r+1],n=O[r+2];Z.moveTo(R.x,R.y),Z.bezierCurveTo(L.x,L.y,D.x,D.y,n.x,n.y);break}r+=3}else if(5===U&&d===m){var R=O[r-1],n=O[0];Z.moveTo(R.x,R.y),Z.lineTo(n.x,n.y);break}}Z.stroke()}Z.beginPath(),r=0,Z.strokeStyle=x,Z.lineWidth=1,Z.fillStyle=g;for(var m=0;t>m;m++){var U=F.get(m);if(1===U||2===U){var n=O[r];Z.moveTo(n.x+p,n.y),Z.arc(n.x,n.y,p,0,v,!0),r++}else if(3===U){var n=O[r+1];Z.moveTo(n.x+p,n.y),Z.arc(n.x,n.y,p,0,v,!0),r+=2}else if(4===U){var n=O[r+2];Z.moveTo(n.x+p,n.y),Z.arc(n.x,n.y,p,0,v,!0),r+=3}}Z.fill(),Z.stroke(),Z.beginPath(),r=0,Z.strokeStyle=o,Z.lineWidth=1,Z.fillStyle=E;for(var m=0;t>m;m++){var U=F.get(m);if(1===U||2===U)r++;else if(3===U){var w=O[r];Z.moveTo(w.x+p,w.y),Z.arc(w.x,w.y,p,0,v,!0),r+=2}else if(4===U){var L=O[r],D=O[r+1];Z.moveTo(L.x+p,L.y),Z.arc(L.x,L.y,p,0,v,!0),Z.moveTo(D.x+p,D.y),Z.arc(D.x,D.y,p,0,v,!0),r+=3}}if(Z.fill(),Z.stroke(),Z.beginPath(),r=0,Z.strokeStyle=$,Z.lineWidth=2,(k===y||T===y)&&G.$9l!=i){var n=O[G.$9l];Z.moveTo(n.x+p,n.y),Z.arc(n.x,n.y,p,0,v,!0),Z.stroke()}}}}),G.$87l&&z.sm().contains(G.$87l)){var td,bq=G.$87l,Ei=G.$88l,Kl=z.getEditHelperSize(),Mr=Kl/2;if(z.isHelperEditable(bq,"pointElevation"))if(bq instanceof W){var wc=bq.getPosition();td=q.clone(bq.getPoints().get(Ei)),td=Ck({x:wc.x,y:wc.y},td.x-wc.x,td.y-wc.y,bq.getRotation()),td.x*=b,td.y*=b,Z.translate(td.x,td.y),q.drawImage(Z,q.getImage("xeditinteractor_elevationIcon"),Mr,-Mr,Kl,Kl),Z.translate(-td.x,-td.y),G._pointElevationHelperPoint={x:td.x+Kl,y:td.y}}else if(bq instanceof h){var Sn=Ln(z.getDataUI(bq),bq.s("edge.points")),td=q.clone(Sn.get(Ei));td.x*=b,td.y*=b,Z.translate(td.x,td.y),q.drawImage(Z,q.getImage("xeditinteractor_elevationIcon"),Mr,-Mr,Kl,Kl),Z.translate(-td.x,-td.y),G._pointElevationHelperPoint={x:td.x+Kl,y:td.y}}}Z.restore(),G.$5l=0}},$89l:function(G,A,L,i){G.save();var r=this,D=r.gv,F=D.getEditHelperSize(),u=F/2;G.beginPath(),G.translate(L.x,L.y),G.rotate(A),q.drawImage(G,i,-u,-u,F,F),G.restore()},$85l:function(n,$,T){var V=this;V.$90l=T,V.$89l(n,$,T,q.getImage("xeditinteractor_elevationIcon"))},$86l:function(x,r,w){var l=this;l.$91l=w,l.$89l(x,r,w,q.getImage("xeditinteractor_tallIcon"))},$77l:function(J,Z,X){var n=this;n.$68l=X,n.$89l(J,Z,X,q.getImage("xeditinteractor_hostIcon"))},$80l:function(h,K,T){var t=this;t.$70l=T,t.$89l(h,K,T,q.getImage("xeditinteractor_edgeIcon"))},$81l:function(A,z,O){var G=this;G.$71l=O,G.$89l(A,z,O,q.getImage("xeditinteractor_removeIcon"))},$76l:function(t,G,v){var E=this;E.$69l=v,E.$89l(t,G,v,q.getImage("xeditinteractor_parentIcon"))},$84l:function($,r,g,n,u){var j,Z=this,b=Z.gv,O=b.getZoom(),z=b.getEditHelperSize(),J=z/2;g.x*=O,g.y*=O,u&&(n?g.x-=J+5:g.x+=J+5),g.y-=z-2,n?(Z.$82l=g,j=q.getImage("xeditinteractor_sourceIcon")):(Z.$83l=g,j=q.getImage("xeditinteractor_targetIcon")),$.beginPath(),$.translate(g.x,g.y),q.drawImage($,j,-J,-J,z,z),$.translate(-g.x,-g.y)},$44l:function(s,e,H){s.save();var p=this.gv.getZoom(),t=V(M(e.width,2)+M(e.height,2))/2*p+10,g=t,f=g+8,K=g+18,b=H,c=e.x+e.width/2,l=e.y+e.height/2;s.translate(c*p,l*p),s.beginPath(),s.strokeStyle="rgb(150, 150, 150)";for(var o=0,P=0,E=0,Z=0,O=0,L=0;360>L;L++)o=L*Y/180,0===L%5&&(P=N(o)*g,E=a(o)*g,Z=N(o)*f,O=a(o)*f,s.moveTo(P,E),s.lineTo(Z,O)),0===L%45&&(P=N(o)*g,E=a(o)*g,Z=N(o)*K,O=a(o)*K,s.moveTo(P,E),s.lineTo(Z,O));s.stroke(),s.beginPath(),s.rotate(-n),s.beginPath(),s.fillStyle="rgba(255, 0, 0, 0.1)",s.strokeStyle="rgb(157, 157, 157)",s.moveTo(0,0),s.arc(0,0,K,0,H,!1),s.fill(),s.beginPath(),s.moveTo(0+K,0),s.arc(0,0,K,0,H,!1),s.stroke(),s.rotate(n),s.font="bold 12px Verdana, Arial";var v=20*a(b),X=20*N(b),u=$(180*b/Y)+"°";s.textAlign="center",s.textBaseline="middle",s.beginPath();var R=s.measureText("365.°").width;s.fillStyle="white",s.rect(v-R/2,-X-10,R,20),s.fill(),s.beginPath(),s.fillStyle="rgb(79,79,79)",s.fillText(u,v,-X),s.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);