!function(W,d){"use strict";var w="position",D="absolute",B="relative",h="px",J="left",j="right",U="top",$="bottom",t="display",v="none",P="block",Z=ht.Default,u=Z.getInternal(),I=Math.floor,T=Math.ceil,c=Math.PI,p=null,Q=W.parseInt,g=function(E){return E.getContext("2d")},Y=function(){return document},L=function(u){return Y().createElement(u)},n=function(){return L("canvas")},s=function(I,q,f){I.style.setProperty(q,f,p)},e=function(o,g,h){Z.def(ht.widget[o],g,h)},x=function(Q,z){Q.appendChild(z)},F=function(y,R){y.removeChild(R)},u=Z.getInternal(),z=u.addEventListener,R=u.removeEventListener;ht.widget.RulerFrame=function(b){var r=this,W=r._view=u.createView(null,r),l=r.$1k=n(),S=r.$2k=n(),E=r.$3k=n(),J=r.$4k=n();r._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},r._topRulerConfig={visible:!0},r._rightRulerConfig={visible:!1},r._bottomRulerConfig={visible:!1},r._leftRulerConfig={visible:!0},x(W,l),x(W,E),x(W,S),x(W,J),s(W,w,B),s(W,"box-sizing","border-box"),s(W,"-moz-box-sizing","border-box"),s(l,w,D),s(S,w,D),s(E,w,D),s(J,w,D),r.$14k=function(){r.$13k=1,r.iv()},r.$15k=function(N){if(r._topRulerConfig.guideVisible||r._rightRulerConfig.guideVisible||r._bottomRulerConfig.guideVisible||r._leftRulerConfig.guideVisible||r._defaultRulerConfig.guideVisible||(r._topRulerConfig.guideTipVisible||r._rightRulerConfig.guideTipVisible||r._bottomRulerConfig.guideTipVisible||r._leftRulerConfig.guideTipVisible||r._defaultRulerConfig.guideTipVisible)&&r._component){var v=W.getBoundingClientRect();r.$16k={x:N.clientX-v.left,y:N.clientY-v.top},r.$5k()}},r.setComponent(b)},e("RulerFrame",d,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(e){var n=this,r=n._component,H=n.getView();if(H){if(n._component=e,n.fp("component",r,e),r){var N=n.getComponentView(r);F(H,N),R(H,"mousemove",n.$15k),n.removeComponentPropertyChangeListener(r,n.$14k)}if(e){var j=n.getComponentView(e);x(H,j),s(j,w,D),z(H,"mousemove",n.$15k),n.addComponentPropertyChangeListener(e,n.$14k)}}},addComponentPropertyChangeListener:function(u,z){u&&u.mp&&u.mp(z)},removeComponentPropertyChangeListener:function(c,s){c&&c.ump&&c.ump(s)},getComponentHZoom:function($){return $&&$.getZoom?$.getZoom():1},getComponentVZoom:function(A){return A&&A.getZoom?A.getZoom():1},getComponentViewRect:function(X){return X&&X.getViewRect?X.getViewRect():void 0},getComponentView:function(i){return i&&i.getView?i.getView():i},invalidateComponent:function(Q){Q&&Q.iv&&Q.iv()},validateComponent:function(L){L&&L.validate&&L.validate()},$7k:function(j,h,W,q,V,c,e,E,$,X,r,D){if(h.visible){var Q=this._defaultRulerConfig,K="borderStyle",B="borderColor",i="borderWidth",m="background",L=h[K]||Q[K],x=h[B]||Q[B],M=h[i]||Q[i],F=h.size!=p?h.size:Q.size,Y=h[m]||Q[m],n=F+M,I=this.$6k(M,L,x,j,W,V,n,e,E,$,X,r,D);s(j,V,"0px"),c?u.setCanvas(j,q-I,F):u.setCanvas(j,F,q-I),s(j,"background",Y),s(j,t,P)}else s(j,t,v),s(this.getComponentView(this._component),V,"0px")},$6k:function(B,z,I,n,G,w,S,g,f,d,P,_,k){var o=0;return s(n,G,B+"px "+z+" "+I),s(this.getComponentView(this._component),w,S+h),g?(s(n,f,d+h),o+=d):s(n,f,"0px"),P?(s(n,_,k+h),o+=k):s(n,_,"0px"),o},validateImpl:function(){var f=this,w=f._component,V=f.$1k,l=f.$2k,t=f.$3k,m=f.$4k,r=f._view,L=f._defaultRulerConfig,S=f._topRulerConfig,D=f._rightRulerConfig,y=f._bottomRulerConfig,T=f._leftRulerConfig,i=L.size;if(r&&w){var g=S.size!=p?S.size:i,I=D.size!=p?D.size:i,q=y.size!=p?y.size:i,K=T.size!=p?T.size:i;f.$7k(V,S,"border-bottom",r.offsetWidth,U,!0,T.visible,J,K,D.visible,j,I),f.$7k(l,D,"border-left",r.offsetHeight,j,!1,S.visible,U,g,y.visible,$,q),f.$7k(t,y,"border-top",r.offsetWidth,$,!0,T.visible,J,K,D.visible,j,I),f.$7k(m,T,"border-right",r.offsetHeight,J,!1,S.visible,U,g,y.visible,$,q),f.$13k?delete f.$13k:f.invalidateComponent(w),f.validateComponent(w),f.$5k()}},$5k:function(){function $(W,K,f,T,v,$){if(K.visible){var E=g(W),q=K[X]||l,w=K[k]!=p?K[k]:B,j=K[Y]||R,I=K[h]||H,i=K.size!=p?K.size:P,Vr=K[Z]||C,_k=K[u]||A,Ek=K[d]||e,Bl=K[U]!=p?K[U]:c,Bq=K[O]!=p?K[O]:a,bj=K[t]!=p?K[t]:V,ul=K[m]!=p?K[m]:_,Xk=K[M]!=p?K[M]:y,fe=K[F]!=p?K[F]:n,Pb=K[b]||gs,ii=K[S]||Cg;w&&(q=r[$]=r.$8k(r[$]||q,K[L]||J,K[Q]||s,T?x:G,_k)),f.call(r,E,o,D,z,N,i,T?x:G,q,j,I,v,Vr,Ek);var Yd=r.$16k;(Bl||Bq)&&Yd&&(T?r.$9k(E,Yd.x,i,Pb,ii,Bl,Bq,bj,ul,Xk,fe):r.$10k(E,Yd.y,i,Pb,ii,Bl,Bq,bj,ul,Xk,fe,v))}}var r=this,v=r.$1k,W=r.$2k,I=r.$3k,K=r.$4k,i=r._topRulerConfig,w=r._rightRulerConfig,j=r._bottomRulerConfig,f=r._leftRulerConfig,T=r._defaultRulerConfig,q=r._component,E=r.getComponentViewRect(q),x=r.getComponentHZoom(q),G=r.getComponentVZoom(q),o=E.x*x,z=o+E.width*x,D=E.y*G,N=D+E.height*G,P=r._defaultRulerConfig.size,X="defaultMajorTickSpacing",L="maxPhysicalMajorTickSpacing",Q="minPhysicalMajorTickSpacing",k="tickSpacingAdaptable",Y="majorTickTextFont",h="majorTickTextColor",Z="majorTickColor",d="minorTickColor",U="guideVisible",O="guideTipVisible",t="guideTipBorderColor",m="guideTipTextColor",M="guideTipTextFont",F="guideTipBackground",b="guideColor",S="guideWidth",u="minMajorTickSpacing",l=T[X],J=T[L],s=T[Q],B=T[k],R=T[Y],H=T[h],C=T[Z],A=T[u],e=T[d],c=T[U],a=T[O],V=T[t],_=T[m],y=T[M],n=T[F],gs=T[b],Cg=T[S];r._view&&q&&($(v,i,r.$11k,!0,!1,"_currentTopMajorTickSpacing"),$(W,w,r.$12k,!1,!0,"_currentRightMajorTickSpacing"),$(I,j,r.$11k,!0,!0,"_currentBottomMajorTickSpacing"),$(K,f,r.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(D,L,N,v,w){return N>D*v?D=I(L/v/w)*w:D*v>L&&(D=T(N/v/w)*w),D},getHTipText:function(j){var m=this,S=m._component,W=0,A=m._view.getBoundingClientRect();return S.lp?W=Q(S.lp({x:j.x+A.left,y:j.y}).x):W-=Q(this.getComponentView(S).style.left)||0,W},$9k:function(K,V,m,Z,y,o,k,A,W,Y,v){var M=this,l=M._component;K.save(),u.translateAndScale(K,0,0,1);var b=V-(Q(this.getComponentView(l).style.left)||0),z=0;if(V=M.getHTipText(M.$16k),o&&(K.beginPath(),K.fillStyle=Z,K.rect(b,z,y,m),K.fill()),k){K.beginPath(),K.textAlign="center",K.textBaseline="middle",K.font=Y;var S=K.measureText(V).width+6;K.fillStyle=v,K.rect(b-S/2,z,S,m),K.fill(),K.strokeStyle=A,K.stroke(),K.beginPath(),K.fillStyle=W,K.fillText(V,b,z+m/2)}K.restore()},getVTipText:function(m){var X=this,F=X._component,M=0,B=X._view.getBoundingClientRect();return F.lp?M=Q(F.lp({x:m.x,y:m.y+B.top}).y):M-=Q(this.getComponentView(F).style.top)||0,M},formatScaleText:function(I){return Math.round(I)},$10k:function(f,x,A,Z,_,e,C,b,T,z,K,v){var i=this,p=i._component;f.save(),u.translateAndScale(f,0,0,1);var E=A/2,l=x-(Q(this.getComponentView(p).style.top)||0);if(x=i.getVTipText(i.$16k),e&&(f.beginPath(),f.fillStyle=Z,f.rect(E-A/2,l,A,_),f.fill()),C){f.translate(E,l),f.rotate((v?90:-90)*c/180),f.translate(-E,-l),f.beginPath(),f.textAlign="center",f.textBaseline="middle",f.font=z;var j=f.measureText(x).width+6;f.fillStyle=K,f.rect(E-j/2,l-A/2,j,A),f.fill(),f.strokeStyle=b,f.stroke(),f.fillStyle=T,f.fillText(x,E,l)}f.restore()},$11k:function(W,U,L,q,m,t,J,X,c,n,P,g,h){W.save(),L=0;var b=U,r=q,j=(b+r)/2;U=0,q=r-b,u.translateAndScale(W,0,0,1);var i=0,R=0,M=Q(t/2),l=t-M,K=P?0:M,V=X*J,x=V/10;U-=V,q+=V,W.clearRect(U,0,q-U,t),W.beginPath(),W.fillStyle=h;var C=I(j/x)*x-b;for(i=C;q>i;i+=x)W.rect(i,L+K,1,l);for(i=C;i>U;i-=x)W.rect(i,L+K,1,l);for(W.fill(),K=P?0:1,W.beginPath(),W.fillStyle=g,C=I(j/V)*V-b,i=C;q>i;i+=V)W.rect(i,L+K,1,t-1);for(i=C;i>U;i-=V)W.rect(i,L+K,1,t-1);W.fill();var d=Q(/\d+px/.exec(c)[0]),A=(d||10)/2;W.textBaseline="middle",K=P?t-A-2:A+2,W.beginPath(),W.fillStyle=n,W.font=c;var H=I(j/V)*V/J;for(i=C,R=H;q>i;i+=V,R+=X){var w=this.getHScaleText?this.getHScaleText(i):R;W.fillText(this.formatScaleText(w),i+2,L+K)}for(i=C,R=H;i>U;i-=V,R-=X){var w=this.getHScaleText?this.getHScaleText(i):R;W.fillText(this.formatScaleText(w),i+2,L+K)}W.restore()},$12k:function(h,m,l,V,v,t,U,e,f,F,b,a,i){function x(s,V,g,p,l,$){l=k.getVScaleText?k.getVScaleText(g):l,l=k.formatScaleText(l),h.translate(s+V,g),h.rotate(-p),h.translate(-s-V,-g),h.fillText(l,s+V+($?2:1),g),h.translate(s+V,g),h.rotate(p),h.translate(-s-V,-g)}h.save(),m=0;var w=l,J=v,n=(w+J)/2;l=0,v=J-w,u.translateAndScale(h,0,0,1);var o=0,k=this,H=0,r=Q(t/2),B=t-r,X=b?0:r,d=e*U,R=d/10;l-=d,v+=d,h.clearRect(m,0,t,v-l),h.beginPath(),h.fillStyle=i;var y=I(n/R)*R-w;for(o=y;v>o;o+=R)h.rect(m+X,o,B,1);for(o=y;o>l;o-=R)h.rect(m+X,o,B,1);for(h.fill(),X=b?0:1,h.beginPath(),h.fillStyle=a,y=I(n/d)*d-w,o=y;v>o;o+=d)h.rect(m+X,o,t-1,1);for(o=y;o>l;o-=d)h.rect(m+X,o,t-1,1);h.fill();var W=Q(/\d+px/.exec(f)[0]),p=(W||10)/2,C=90*c/180;h.textBaseline="middle",X=b?t-p:p+2,C=b?-C:C,h.beginPath(),h.fillStyle=F,h.font=f;var _=I(n/d)*d/U;for(o=y,H=_;v>o;o+=d,H+=e)x(m,X,o,C,H,b);for(o=y,H=_;o>l;o-=d,H-=e)x(m,X,o,C,H,b);h.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var O=this,X=O._component,q=O._view;X&&O.removeComponentPropertyChangeListener(X,O.$14k),q&&(R(q,"mousemove",O.$15k),F(q.parentNode,q),O._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);