!function(e){"use strict";function H(F){var C,R,q,U,W,b,w,z=[],n=0;C=B.createDiv(!0);var t=F.getView();t.insertBefore(C,F.getCanvas()),R=X.Default.createDiv(),R.style.WebkitTransformStyle="preserve-3d",R.style.MozTransformStyle="preserve-3d",R.style.transformStyle="preserve-3d",C.appendChild(R),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(r){var W=r.style;Z.addEventListener(t,r.event,function(){F.isDragProtectForWebView()&&(C.style.pointerEvents=W)})}),this.updateWebView=function(){if(F.getWidth()&&F.getHeight()){var $=F.getCanvas(),K=1*$.style.width.slice(0,-2),i=1*$.style.height.slice(0,-2);(z[0]!==K||z[1]!==i)&&(z[0]=K,z[1]=i,C.style.width=K+"px",C.style.height=i+"px",R.style.width=K+"px",R.style.height=i+"px");var E=F._projectMatrix[5]*z[1]/2;E!==q&&(q=E,C.style.WebkitPerspective=q+"px",C.style.MozPerspective=q+"px",C.style.perspective=q+"px"),b="translateZ("+q+"px)"+A(F._viewMatrix);var G=b+"translate("+z[0]/2+"px,"+z[1]/2+"px)";U===G||W||(R.style.WebkitTransform=G,R.style.MozTransform=G,R.style.transform=G,U=G),n++,w=!1,F.dm().each(function(O){O.isWebView&&p(O)});for(var c,B=R.children,r=[],e=0,s=B.length;s>e;e++)c=B[e],c._isHtWebView&&c._renderCookie!==n&&r.push(c);r.length&&r.forEach(function(e){R.removeChild(e)})}};var c=new Array(16),p=function(x){var J=x.getAttach();if(J){var g=F.isVisible(x);if(g&&J.parentNode!==R?R.appendChild(J):!g&&J.parentNode&&B.removeHTML(J),g){J._renderCookie=n,w=!0;var M=x.getFinalScale3d(),K=x._prefrenceSize;K&&K[0]?K[1]||(K[1]=K[0]/M[0]*M[1]):K=[M[0],M[1]],J.style.width=K[0]+"px",J.style.height=K[1]+"px";var j=1/K[0],p=1/K[1],Z=1,D=x.mat;c[0]=D[0]*j,c[1]=D[1]*j,c[2]=D[2]*j,c[3]=D[3]*j,c[4]=D[4]*p,c[5]=D[5]*p,c[6]=D[6]*p,c[7]=D[7]*p,c[8]=D[8]*Z,c[9]=D[9]*Z,c[10]=D[10]*Z,c[11]=D[11]*Z,c[12]=D[12],c[13]=D[13],c[14]=D[14],c[15]=D[15];var y=Y(c,W?"translate("+z[0]/2+"px,"+z[1]/2+"px)"+b:""),X=J.$a2;X!==y&&(J.$a2=y,J.style.WebkitTransform=y,J.style.MozTransform=y,J.style.transform=y)}}}}function I(I){return Math.abs(I)<1e-10?0:I}function A(i){var A=i;return"matrix3d("+I(A[0])+","+I(-A[1])+","+I(A[2])+","+I(A[3])+","+I(A[4])+","+I(-A[5])+","+I(A[6])+","+I(A[7])+","+I(A[8])+","+I(-A[9])+","+I(A[10])+","+I(A[11])+","+I(A[12])+","+I(-A[13])+","+I(A[14])+","+I(A[15])+")"}function Y(W,O){var Q=W,J="matrix3d("+I(Q[0])+","+I(Q[1])+","+I(Q[2])+","+I(Q[3])+","+I(-Q[4])+","+I(-Q[5])+","+I(-Q[6])+","+I(-Q[7])+","+I(Q[8])+","+I(Q[9])+","+I(Q[10])+","+I(Q[11])+","+I(Q[12])+","+I(Q[13])+","+I(Q[14])+","+I(Q[15])+")";return"translate(-50%,-50%)"+(O||"")+J}var C="ht",X=e[C],B=X.Default,Z=B.getInternal(),U=Z.superCall,L=X.graph3d.Graph3dView,y=L.prototype.validateImpl;L.prototype.validateImpl=function(){y.call(this);var j=this._webViewRenderer;j||(j=this._webViewRenderer=new H(this)),j.updateWebView()},L.prototype.isDragProtectForWebView=function(){return this._dragProtectForWebView},L.prototype.setDragProtectForWebView=function(m){this._dragProtectForWebView=m};var p=X.WebView3d=function(){var v=this;U(p,v),v.s({shape3d:"billboard","shape3d.reverse.flip":!0})},g=[1,1,1,1],J=[0,0,0,0];B.def(C+"."+"WebView3d",X.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(K,d,r){if(!K)return this.detachDOM();if("string"==typeof K){var c=document.createElement("iframe");c.src=K,K=c}var q=K.style;q.position="absolute",q.border=0,q.outline=0,q.padding=0,q.margin=0,K._isHtWebView=!0,this.setAttach(K),this._prefrenceSize=[d,r],this.s("shape3d.blend",J)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(U){this.a("defaultBgColor",U),this.getAttach()||this.s("shape3d.blend",U)},getBgColor:function(){return this.a("defaultBgColor")||g}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);