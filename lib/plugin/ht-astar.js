!function(n,K,o){"use strict";var j=n.ht;j.Astar={},function(J){var t=J();n.AStar=t.astar,n.AStar.Graph=t.Graph}(function(){function h(E){for(var h=E,N=[];h.parent;)N.unshift(h),h=h.parent;return N}function s(){return new K(function(C){return C.f})}function Y(J,K){K=K||{},this.nodes=[],this.diagonal=!!K.diagonal,this.grid=[];for(var h=0;h<J.length;h++){this.grid[h]=[];for(var q=0,F=J[h];q<F.length;q++){var S=new d(h,q,F[q]);this.grid[h][q]=S,this.nodes.push(S)}}this.$13x()}function d(F,n,M){this.x=F,this.y=n,this.weight=M}function K(X){this.content=[],this.scoreFunction=X}var q={search:function(u,Z,B,x){u.$6x(),x=x||{};var j=x.heuristic;j||(j=u.diagonal?q.$4x.diagonal:q.$4x.manhattan);var F=x.closest||!1,c=x.punish,S=s(),f=Z;for(Z.h=j(Z,B),u.$7x(Z),S.push(Z);S.size()>0;){var Q=S.pop();if(Q===B)return h(Q);Q.closed=!0;for(var t=u.neighbors(Q),G=0,J=t.length;J>G;++G){var A=t[G];if(!A.closed&&!A.$9x()){var n=Q.g+A.getCost(Q,c),U=A.visited;(!U||n<A.g)&&(A.visited=!0,A.parent=Q,A.h=A.h||j(A,B),A.g=n,A.f=A.g+A.h,u.$7x(A),F&&(A.h<f.h||A.h===f.h&&A.g<f.g)&&(f=A),U?S.$10x(A):S.push(A))}}}return F?h(f):[]},$4x:{manhattan:function(R,u){var z=Math.abs(u.x-R.x),j=Math.abs(u.y-R.y);return z+j},diagonal:function(t,P){var c=1,C=Math.sqrt(2),b=Math.abs(P.x-t.x),f=Math.abs(P.y-t.y);return c*(b+f)+(C-2*c)*Math.min(b,f)}},$5x:function(L){L.f=0,L.g=0,L.h=0,L.visited=!1,L.closed=!1,L.parent=null}};return Y.prototype.$13x=function(){this.dirtyNodes=[];for(var K=0;K<this.nodes.length;K++)q.$5x(this.nodes[K])},Y.prototype.$6x=function(){for(var x=0;x<this.dirtyNodes.length;x++)q.$5x(this.dirtyNodes[x]);this.dirtyNodes=[]},Y.prototype.$7x=function(v){this.dirtyNodes.push(v)},Y.prototype.neighbors=function(Q){var k=[],_=Q.x,J=Q.y,W=this.grid;return W[_-1]&&W[_-1][J]&&k.push(W[_-1][J]),W[_+1]&&W[_+1][J]&&k.push(W[_+1][J]),W[_]&&W[_][J-1]&&k.push(W[_][J-1]),W[_]&&W[_][J+1]&&k.push(W[_][J+1]),this.diagonal&&(W[_-1]&&W[_-1][J-1]&&k.push(W[_-1][J-1]),W[_+1]&&W[_+1][J-1]&&k.push(W[_+1][J-1]),W[_-1]&&W[_-1][J+1]&&k.push(W[_-1][J+1]),W[_+1]&&W[_+1][J+1]&&k.push(W[_+1][J+1])),k},Y.prototype.toString=function(){for(var M=[],J=this.grid,X=0;X<J.length;X++){for(var o=[],p=J[X],g=0;g<p.length;g++)o.push(p[g].weight);M.push(o.join(" "))}return M.join("\n")},d.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},d.prototype.getCost=function($,v){var h;if(h=$&&$.x!=this.x&&$.y!=this.y?1.41421*this.weight:this.weight,v){var L=$;if(!L)return h;var b=L.parent;if(!b)return h;if(Math.abs(b.x+this.x-2*L.x)>1e-5)return h+v;if(Math.abs(b.y+this.y-2*L.y)>1e-5)return h+v}return h},d.prototype.$9x=function(){return 0===this.weight},K.prototype={push:function(V){this.content.push(V),this.$11x(this.content.length-1)},pop:function(){var i=this.content[0],q=this.content.pop();return this.content.length>0&&(this.content[0]=q,this.$12x(0)),i},remove:function(L){var X=this.content.indexOf(L),y=this.content.pop();X!==this.content.length-1&&(this.content[X]=y,this.scoreFunction(y)<this.scoreFunction(L)?this.$11x(X):this.$12x(X))},size:function(){return this.content.length},$10x:function($){this.$11x(this.content.indexOf($))},$11x:function(v){for(var m=this.content[v];v>0;){var P=(v+1>>1)-1,O=this.content[P];if(!(this.scoreFunction(m)<this.scoreFunction(O)))break;this.content[P]=m,this.content[v]=O,v=P}},$12x:function(V){for(var J=this.content.length,t=this.content[V],P=this.scoreFunction(t);;){var _,i=V+1<<1,X=i-1,e=null;if(J>X){var n=this.content[X];_=this.scoreFunction(n),P>_&&(e=X)}if(J>i){var W=this.content[i],L=this.scoreFunction(W);(null===e?P:_)>L&&(e=i)}if(null===e)break;this.content[V]=this.content[e],this.content[e]=t,V=e}}},{astar:q,Graph:Y}});var Y=j.Astar.Finder=function(q,r){var V=this;V.gv=q,V.$13x(r),V.refreshMap()};Y.prototype={},Y.prototype.constructor=Y,K.defineProperties(Y.prototype,{_debugInfo:{get:function(){return this.gv._astarDebugInfo},set:function(H){this.gv._astarDebugInfo=H}}}),Y.prototype.$13x=function(C){var $=this,W=$.$14x={};C=C||{};var x=C.gridSize||10;W.gridSizeX=C.gridSizeX||x,W.gridSizeY=C.gridSizeY||x,W.rect=C.rect,W.filter=C.filter,W.extendBlocks=C.extendBlocks||3,W.fastOverlap=C.fastOverlap===o?!0:C.fastOverlap,W.nodeRectExtend=C.nodeRectExtend||0,W.diagonal=C.diagonal===o?!0:C.diagonal,W.turnPunish=C.turnPunish===o?.1:C.turnPunish,W.simplify=C.simplify===o?!0:C.simplify,W.toGridCenter=C.toGridCenter===o?!1:C.toGridCenter,W.closest=C.closest===o?!0:C.closest},Y.prototype.refreshMap=function(){var p,T=this,s=T.$14x,e=s.gridSizeX,o=s.gridSizeY,M=s.extendBlocks;s.rect?p=s.rect:(p=T.$15x(),j.Default.grow(p,e*M,o*M)),j.Default.grow(p,e,o);var K=Math.floor(p.x/e)*e,S=Math.floor(p.y/o)*o,k=Math.ceil(p.width/e),$=Math.ceil(p.height/o),u=k*e,C=$*o;T.$16x={x:K,y:S,w:u,h:C,gridX:e,gridY:o,xLen:k,yLen:$},T.$17x(),T.$21x()},Y.prototype.$15x=function(){var i=this.gv;if(i instanceof j.graph.GraphView)return i.getContentRect();var V,r=j.Default.unionRect;return i.dm().each(function(T){i.isVisible(T)&&T.getRect&&(V=r(V,T.getRect()))}),V},Y.prototype.$17x=function(){var G,O,K,j,h=this,N=h.$16x,X=N.xLen,S=N.yLen;for(G=new Array(X),K=0;X>K;K++)for(G[K]=O=new Array(S),j=S;j--;)O[j]=1;var b=h.$14x.filter;for(h.gv.dm().each(function(T){b&&b(T)===!1||(!h._debugInfo||T!==h._debugInfo.grid&&T!=h._debugInfo.path)&&h.$1cw(G,T)}),K=0;X>K;K++)G[K][0]=1,G[K][S-1]=1;for(j=0;S>j;j++)G[0][j]=1,G[X-1][j]=1;h.grid=G;var q=new AStar.Graph(G,{diagonal:h.$14x.diagonal});h.graph=q},Y.prototype.$18x=function(N,X,F,B,h,Y,P,E){var x=this.$19x,R=x(F-N,h-P,B-X,Y-E);if(1e-6>=R&&R>=-1e-6)return!1;var A=x(h-N,h-P,Y-X,Y-E)/R;if(0>A||A>1)return!1;var o=x(F-N,h-N,B-X,Y-X)/R;return 0>o||o>1?!1:!0},Y.prototype.$19x=function(j,F,l,w){return j*w-F*l},Y.prototype.$1aw=function(g,J,q,p){for(var T=[-(J[1]-g[1]),J[0]-g[0]],y=T[0]*(q[0]-g[0])+T[1]*(q[1]-g[1])>=0,u=0,I=p.length;I>u;u+=2)if(T[0]*(p[u]-g[0])+T[1]*(p[u+1]-g[1])>=0===y)return!1;return!0},Y.prototype.$1bw=function(g,P){for(var G,i,x=this,R=0,E=g.length;E>R;R+=2)if(G=R===E-2?0:R+2,i=G===E-2?0:G+2,x.$1aw([g[R],g[R+1]],[g[G],g[G+1]],[g[i],g[i+1]],P))return!1;for(var R=0,E=P.length;E>R;R+=2)if(G=R===E-2?0:R+2,i=G===E-2?0:G+2,x.$1aw([P[R],P[R+1]],[P[G],P[G+1]],[P[i],P[i+1]],g))return!1;return!0},Y.prototype.$1cw=function(h,O){if(O.getRect){var m=this,L=O.getRect();j.Default.grow(L,m.$14x.nodeRectExtend);var c,a,f,v,s,l,P,V,y,d,g,N=m.$1dw({x:L.x,y:L.y}),Z=m.$1dw({x:L.x+L.width,y:L.y+L.height}),i=m.$14x.fastOverlap;if(!i){var _=O.getCorners();P=[],_.forEach(function(R){P.push(R.x,R.y)}),d=m.$14x.gridSizeX/2,g=m.$14x.gridSizeY/2}for(a=Math.max(0,N.x),f=Math.min(Z.x,h.length-1),s=Math.max(0,N.y),l=Math.min(Z.y,h.length?h[0].length-1:-1),c=a;f>=c;c++)for(v=s;l>=v;v++)if(i)h[c][v]=0;else{y=m.$1ew({x:c,y:v});var E=y.x-d,C=y.x+d,b=y.y-g,p=y.y+g;V=[E,b,E,p,C,p,C,b],m.$1bw(P,V)&&(h[c][v]=0)}}},Y.prototype.$1dw=function(f,y){var V=this,n=V.$16x,P=(f.x-n.x)/n.gridX,C=(f.y-n.y)/n.gridY;return y!==!1&&(P=Math.round(P),C=Math.round(C)),{x:P,y:C}},Y.prototype.$1ew=function(C){var w=this,s=w.$16x;return{x:C.x*s.gridX+s.x,y:C.y*s.gridY+s.y}},Y.prototype.$1fw=function(G){var A=this,r=A.$16x,c=r.xLen,d=r.yLen;if(G.x>=0&&G.x<c&&G.y>=0&&G.y<d)return G;var O={x:G.x,y:G.y};return O.x<0?O.x=0:O.x>=c&&(O.x=c-1),O.y<0?O.y=0:O.y>=d&&(O.y=d-1),O},Y.prototype.findPath=function(J,p){var k,D,P,G,w=this,t=w.$1dw(J),r=w.$1dw(p);if(P=w.$1fw(t),G=w.$1fw(r),P!==t&&G!==r){var $=w.$16x,g=$.x-$.gridX/2,F=$.y-$.gridY/2,T=g+$.gridX*$.xLen,z=F+$.gridY*$.yLen;if(!(w.$18x(J.x,J.y,p.x,p.y,g,F,T,F)||w.$18x(J.x,J.y,p.x,p.y,T,F,T,z)||w.$18x(J.x,J.y,p.x,p.y,T,z,g,z)||w.$18x(J.x,J.y,p.x,p.y,g,z,g,F)))return[J,p]}P!==t&&(k=!0,t=P),G!==r&&(D=!0,r=G);var l=w.graph.grid[t.x][t.y],H=w.graph.grid[r.x][r.y],O=AStar.search(w.graph,l,H,{closest:w.$14x.closest,punish:w.$14x.turnPunish});if(!O||!O.length)return null;var L=[];L.push(J),k&&L.push(w.$1ew(O[0]));for(var W=1,S=O.length;S-1>W;W++)L.push(w.$1ew(O[W]));if(D)L.push(w.$1ew(O[S-1])),L.push(p);else{var d=O[S-1];r.x!==d.x||r.y!==d.y||w.$14x.toGridCenter?L.push(w.$1ew(d)):L.push(p)}return w.$14x.simplify&&(L=w.simplifyPath(L)),w.$20x=L,w.$21x(),L},Y.prototype.debugOn=function(k){this.debugFlag=!0,this.debugSettings=k||{},this.$21x()},Y.prototype.simplifyPath=function(E){var U=E.length;if(2>=U)return E;var c,M,w=[E[0],E[1]],y=w[0],O=w[1],Y=1e-5;for(c=2;U>c;c++)M=E[c],Math.abs((O.x-y.x)*(M.y-y.y)-(O.y-y.y)*(M.x-y.x))<Y?O=w[w.length-1]=M:(y=O,O=M,w.push(M));return w},Y.prototype.$21x=function(){var d=this;if(d.$22x(),this.debugFlag){var G=d.grid;if(G){var z,P=d.gv;if(d.debugSettings.$16x!==!1){z=[];for(var k,H,e,L,J,v=[],Q=d.$14x.gridSizeX/2,I=d.$14x.gridSizeY/2,b=G.length,m=b?G[0].length:0,E=1;b-1>E;E++)for(var M=1;m-1>M;M++)G[E][M]||(k=d.$1ew({x:E,y:M}),H=k.x-Q,e=k.x+Q,L=k.y-I,J=k.y+I,z.push({x:H,y:L},{x:H,y:J},{x:e,y:J},{x:e,y:L}),v.push(1,2,2,2,5));var w=new j.Shape;w.s("shape.border.color","rgba(50, 50, 50, 0.2)"),w.s("shape.border.width",1),w.s("shape.background","rgba(200, 50, 100, 0.2)"),w.s("2d.editable",!1),w.s("2d.selectable",!1),w.setPoints(z),w.setSegments(v),d._debugInfo={grid:w},P.dm().add(w)}d.debugSettings.path!==!1&&(z=new j.Shape,d.$20x&&(z.setPoints(d.$20x),z.s("shape.border.color","red"),z.s("shape.border.width",1),z.s("2d.editable",!1),z.s("2d.selectable",!1),z.s("shape.background",null),d._debugInfo||(d._debugInfo={}),d._debugInfo.path=z,P.dm().add(z)))}}},Y.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},Y.prototype.$22x=function(){var y=this;if(y._debugInfo){var F=y._debugInfo.grid,B=y._debugInfo.path,u=y.gv;F&&u.dm().remove(F),B&&u.dm().remove(B),y._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);